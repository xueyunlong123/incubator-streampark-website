"use strict";(self.webpackChunkapache_streampark_website=self.webpackChunkapache_streampark_website||[]).push([[9816],{3905:(e,n,a)=>{a.d(n,{Zo:()=>c,kt:()=>k});var t=a(67294);function r(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function s(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,t)}return a}function o(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?s(Object(a),!0).forEach((function(n){r(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function l(e,n){if(null==e)return{};var a,t,r=function(e,n){if(null==e)return{};var a,t,r={},s=Object.keys(e);for(t=0;t<s.length;t++)a=s[t],n.indexOf(a)>=0||(r[a]=e[a]);return r}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(t=0;t<s.length;t++)a=s[t],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var i=t.createContext({}),p=function(e){var n=t.useContext(i),a=n;return e&&(a="function"==typeof e?e(n):o(o({},n),e)),a},c=function(e){var n=p(e.components);return t.createElement(i.Provider,{value:n},e.children)},d="mdxType",m={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},u=t.forwardRef((function(e,n){var a=e.components,r=e.mdxType,s=e.originalType,i=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=p(a),u=r,k=d["".concat(i,".").concat(u)]||d[u]||m[u]||s;return a?t.createElement(k,o(o({ref:n},c),{},{components:a})):t.createElement(k,o({ref:n},c))}));function k(e,n){var a=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var s=a.length,o=new Array(s);o[0]=u;var l={};for(var i in n)hasOwnProperty.call(n,i)&&(l[i]=n[i]);l.originalType=e,l[d]="string"==typeof e?e:r,o[1]=l;for(var p=2;p<s;p++)o[p]=a[p];return t.createElement.apply(null,o)}return t.createElement.apply(null,a)}u.displayName="MDXCreateElement"},53922:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>i,contentTitle:()=>o,default:()=>d,frontMatter:()=>s,metadata:()=>l,toc:()=>p});var t=a(87462),r=(a(67294),a(3905));const s={slug:"streampark-usercase-bondex-with-paimon",title:"\u6d77\u7a0b\u90a6\u8fbe\u57fa\u4e8e Apache Paimon + StreamPark \u7684\u6d41\u5f0f\u6570\u4ed3\u5b9e\u8df5",tags:["StreamPark","\u751f\u4ea7\u5b9e\u8df5","paimon","streaming-warehouse"]},o=void 0,l={permalink:"/zh-CN/blog/streampark-usercase-bondex-with-paimon",editUrl:"https://github.com/apache/incubator-streampark-website/edit/dev/blog/3-streampark-usercase-bondex-paimon.md",source:"@site/i18n/zh-CN/docusaurus-plugin-content-blog/3-streampark-usercase-bondex-paimon.md",title:"\u6d77\u7a0b\u90a6\u8fbe\u57fa\u4e8e Apache Paimon + StreamPark \u7684\u6d41\u5f0f\u6570\u4ed3\u5b9e\u8df5",description:"\u5bfc\u8bfb\uff1a\u672c\u6587\u4e3b\u8981\u4ecb\u7ecd\u4f5c\u4e3a\u4f9b\u5e94\u94fe\u7269\u6d41\u670d\u52a1\u5546\u6d77\u7a0b\u90a6\u8fbe\u5728\u6570\u5b57\u5316\u8f6c\u578b\u8fc7\u7a0b\u4e2d\u91c7\u7528 Paimon + StreamPark \u5e73\u53f0\u5b9e\u73b0\u6d41\u5f0f\u6570\u4ed3\u7684\u843d\u5730\u65b9\u6848\u3002\u6211\u4eec\u4ee5 Apache StreamPark \u6d41\u6279\u4e00\u4f53\u5e73\u53f0\u63d0\u4f9b\u4e86\u4e00\u4e2a\u6613\u4e8e\u4e0a\u624b\u7684\u751f\u4ea7\u64cd\u4f5c\u624b\u518c\uff0c\u4ee5\u5e2e\u52a9\u7528\u6237\u63d0\u4ea4 Flink \u4efb\u52a1\u5e76\u8fc5\u901f\u638c\u63e1 Paimon \u7684\u4f7f\u7528\u65b9\u6cd5\u3002",date:"2024-01-21T04:16:34.000Z",formattedDate:"2024\u5e741\u670821\u65e5",tags:[{label:"StreamPark",permalink:"/zh-CN/blog/tags/stream-park"},{label:"\u751f\u4ea7\u5b9e\u8df5",permalink:"/zh-CN/blog/tags/\u751f\u4ea7\u5b9e\u8df5"},{label:"paimon",permalink:"/zh-CN/blog/tags/paimon"},{label:"streaming-warehouse",permalink:"/zh-CN/blog/tags/streaming-warehouse"}],readingTime:35.005,hasTruncateMarker:!0,authors:[],frontMatter:{slug:"streampark-usercase-bondex-with-paimon",title:"\u6d77\u7a0b\u90a6\u8fbe\u57fa\u4e8e Apache Paimon + StreamPark \u7684\u6d41\u5f0f\u6570\u4ed3\u5b9e\u8df5",tags:["StreamPark","\u751f\u4ea7\u5b9e\u8df5","paimon","streaming-warehouse"]},prevItem:{title:"\u8054\u901a Flink \u5b9e\u65f6\u8ba1\u7b97\u5e73\u53f0\u5316\u8fd0\u7ef4\u5b9e\u8df5",permalink:"/zh-CN/blog/streampark-usercase-chinaunion"},nextItem:{title:"StreamPark \u5728\u987a\u7f51\u79d1\u6280\u7684\u5927\u89c4\u6a21\u751f\u4ea7\u5b9e\u8df5",permalink:"/zh-CN/blog/streampark-usercase-shunwang"}},i={authorsImageUrls:[]},p=[{value:"01 \u516c\u53f8\u4e1a\u52a1\u60c5\u51b5\u4ecb\u7ecd",id:"01-\u516c\u53f8\u4e1a\u52a1\u60c5\u51b5\u4ecb\u7ecd",level:2},{value:"<strong>\u4e1a\u52a1\u80cc\u666f</strong>",id:"\u4e1a\u52a1\u80cc\u666f",level:3},{value:"02 \u5927\u6570\u636e\u6280\u672f\u75db\u70b9\u4ee5\u53ca\u9009\u578b",id:"02-\u5927\u6570\u636e\u6280\u672f\u75db\u70b9\u4ee5\u53ca\u9009\u578b",level:2},{value:"<strong>hadoop\u67b6\u6784</strong>",id:"hadoop\u67b6\u6784",level:3},{value:"<strong>lambda\u67b6\u6784</strong>",id:"lambda\u67b6\u6784",level:3},{value:"<strong>kappa\u67b6\u6784</strong>",id:"kappa\u67b6\u6784",level:3},{value:"<strong>Iceberg</strong>",id:"iceberg",level:3},{value:"<strong>\u6d41\u5f0f\u6570\u4ed3\uff08kappa\u67b6\u6784\u7684\u5ef6\u7eed)</strong>",id:"\u6d41\u5f0f\u6570\u4ed3kappa\u67b6\u6784\u7684\u5ef6\u7eed",level:3},{value:"03 \u751f \u4ea7 \u5b9e \u8df5",id:"03-\u751f-\u4ea7-\u5b9e-\u8df5",level:2},{value:"<strong>\u73af\u5883\u6784\u5efa</strong>",id:"\u73af\u5883\u6784\u5efa",level:3},{value:"<strong>build \u57fa\u7840\u955c\u50cf</strong>",id:"build-\u57fa\u7840\u955c\u50cf",level:3},{value:"<strong>\u4f7f\u7528 StreamPark \u7ba1\u7406\u4f5c\u4e1a</strong>",id:"\u4f7f\u7528-streampark-\u7ba1\u7406\u4f5c\u4e1a",level:3},{value:"<strong>\u6848\u4f8b</strong>",id:"\u6848\u4f8b",level:3},{value:"04 \u95ee\u9898\u6392\u67e5\u5206\u6790",id:"04-\u95ee\u9898\u6392\u67e5\u5206\u6790",level:2},{value:"05  \u672a \u6765 \u89c4 \u5212",id:"05--\u672a-\u6765-\u89c4-\u5212",level:2}],c={toc:p};function d(e){let{components:n,...s}=e;return(0,r.kt)("wrapper",(0,t.Z)({},c,s,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("p",null,(0,r.kt)("img",{src:a(88048).Z,width:"1080",height:"460"})),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u5bfc\u8bfb\uff1a"),"\u672c\u6587\u4e3b\u8981\u4ecb\u7ecd\u4f5c\u4e3a\u4f9b\u5e94\u94fe\u7269\u6d41\u670d\u52a1\u5546\u6d77\u7a0b\u90a6\u8fbe\u5728\u6570\u5b57\u5316\u8f6c\u578b\u8fc7\u7a0b\u4e2d\u91c7\u7528 Paimon + StreamPark \u5e73\u53f0\u5b9e\u73b0\u6d41\u5f0f\u6570\u4ed3\u7684\u843d\u5730\u65b9\u6848\u3002\u6211\u4eec\u4ee5 Apache StreamPark \u6d41\u6279\u4e00\u4f53\u5e73\u53f0\u63d0\u4f9b\u4e86\u4e00\u4e2a\u6613\u4e8e\u4e0a\u624b\u7684\u751f\u4ea7\u64cd\u4f5c\u624b\u518c\uff0c\u4ee5\u5e2e\u52a9\u7528\u6237\u63d0\u4ea4 Flink \u4efb\u52a1\u5e76\u8fc5\u901f\u638c\u63e1 Paimon \u7684\u4f7f\u7528\u65b9\u6cd5\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u516c\u53f8\u4e1a\u52a1\u60c5\u51b5\u4ecb\u7ecd"),(0,r.kt)("li",{parentName:"ul"},"\u5927\u6570\u636e\u6280\u672f\u75db\u70b9\u4ee5\u53ca\u9009\u578b"),(0,r.kt)("li",{parentName:"ul"},"\u751f\u4ea7\u5b9e\u8df5"),(0,r.kt)("li",{parentName:"ul"},"\u95ee\u9898\u6392\u67e5\u5206\u6790"),(0,r.kt)("li",{parentName:"ul"},"\u672a\u6765\u89c4\u5212")),(0,r.kt)("h2",{id:"01-\u516c\u53f8\u4e1a\u52a1\u60c5\u51b5\u4ecb\u7ecd"},"01 \u516c\u53f8\u4e1a\u52a1\u60c5\u51b5\u4ecb\u7ecd"),(0,r.kt)("p",null,"\u6d77\u7a0b\u90a6\u8fbe\u96c6\u56e2\u4e00\u76f4\u4e13\u6ce8\u4e8e\u4f9b\u5e94\u94fe\u7269\u6d41\u9886\u57df\uff0c\u901a\u8fc7\u6253\u9020\u4f18\u79c0\u7684\u56fd\u9645\u5316\u7269\u6d41\u5e73\u53f0\uff0c\u4e3a\u5ba2\u6237\u63d0\u4f9b\u7aef\u5230\u7aef\u4e00\u7ad9\u5f0f\u667a\u6167\u578b\u4f9b\u5e94\u94fe\u7269\u6d41\u670d\u52a1\u3002\u96c6\u56e2\u73b0\u6709\u5458\u5de5 2000 \u4f59\u4eba\uff0c\u5e74\u8425\u4e1a\u989d\u903e 120 \u4ebf\u4eba\u6c11\u5e01\uff0c\u7f51\u7edc\u904d\u53ca\u5168\u7403 200 \u4f59\u4e2a\u6e2f\u53e3\uff0c\u5728\u6d77\u5185\u5916\u6709\u8d85 80 \u5bb6\u5206\u3001\u5b50\u516c\u53f8\uff0c\u52a9\u529b\u4e2d\u56fd\u4f01\u4e1a\u4e0e\u4e16\u754c\u4e92\u8054\u4e92\u901a\u3002"),(0,r.kt)("h3",{id:"\u4e1a\u52a1\u80cc\u666f"},(0,r.kt)("strong",{parentName:"h3"},"\u4e1a\u52a1\u80cc\u666f")),(0,r.kt)("p",null,"\u968f\u7740\u516c\u53f8\u89c4\u6a21\u7684\u4e0d\u65ad\u6269\u5927\u548c\u4e1a\u52a1\u590d\u6742\u6027\u7684\u589e\u52a0\uff0c\u4e3a\u4e86\u66f4\u597d\u5730\u5b9e\u73b0\u8d44\u6e90\u4f18\u5316\u548c\u6d41\u7a0b\u6539\u8fdb\uff0c\u516c\u53f8\u8fd0\u8425\u4e0e\u6d41\u7a0b\u7ba1\u7406\u90e8\u9700\u8981\u5b9e\u65f6\u76d1\u63a7\u516c\u53f8\u7684\u4e1a\u52a1\u8fd0\u8f6c\u60c5\u51b5\uff0c\u4ee5\u786e\u4fdd\u4e1a\u52a1\u6d41\u7a0b\u7684\u7a33\u5b9a\u6027\u548c\u9ad8\u6548\u6027\u3002"),(0,r.kt)("p",null,"\u516c\u53f8\u8fd0\u8425\u4e0e\u6d41\u7a0b\u7ba1\u7406\u90e8\u8d1f\u8d23\u76d1\u7763\u516c\u53f8\u5404\u7c7b\u4e1a\u52a1\u6d41\u7a0b\u7684\u6267\u884c\uff0c\u5305\u62ec\u6d77\u8fd0\u3001\u7a7a\u8fd0\u3001\u94c1\u8fd0\u5404\u4e2a\u5927\u533a\u548c\u4e8b\u4e1a\u90e8\u7684\u8ba2\u5355\u91cf\uff0c\u5927\u5ba2\u6237\u7684\u8ba2\u5355\u91cf\uff0c\u822a\u7ebf\u8ba2\u5355\u91cf\uff0c\u5173\u52a1\u3001\u4ed3\u50a8\u3001\u9646\u8fd0\u5404\u4e2a\u64cd\u4f5c\u7ad9\u70b9\u7684\u59d4\u6258\u91cf\uff0c\u516c\u53f8\u5f53\u5929\u5404\u4e2a\u5927\u533a\u548c\u4e8b\u4e1a\u90e8\u5b9e\u9645\u6536\u5165\u548c\u652f\u51fa\u60c5\u51b5\u7b49\u3002\u901a\u8fc7\u5bf9\u8fd9\u4e9b\u6d41\u7a0b\u7684\u76d1\u63a7\u548c\u5206\u6790\uff0c\u516c\u53f8\u80fd\u591f\u8bc6\u522b\u51fa\u6f5c\u5728\u7684\u95ee\u9898\u548c\u74f6\u9888\uff0c\u63d0\u51fa\u6539\u8fdb\u63aa\u65bd\u548c\u5efa\u8bae\uff0c\u4ee5\u4f18\u5316\u516c\u53f8\u8fd0\u8425\u6548\u7387\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u5b9e\u65f6\u6570\u4ed3\u67b6\u6784\uff1a")),(0,r.kt)("p",null,(0,r.kt)("img",{src:a(10900).Z,width:"1080",height:"447"})),(0,r.kt)("p",null,"\u5f53\u524d\u7cfb\u7edf\u8981\u6c42\u76f4\u63a5\u4ece\u751f\u4ea7\u7cfb\u7edf\u6536\u96c6\u5b9e\u65f6\u6570\u636e\uff0c\u4f46\u5b58\u5728\u591a\u4e2a\u6570\u636e\u6e90\u9700\u8981\u8fdb\u884c\u5173\u8054\u67e5\u8be2\uff0c\u800c\u5e06\u8f6f\u62a5\u8868\u5728\u5904\u7406\u591a\u4e2a\u6570\u636e\u6e90\u65f6\u5c55\u793a\u4e0d\u591f\u53cb\u597d\uff0c\u4e14\u65e0\u6cd5\u518d\u6b21\u805a\u5408\u591a\u4e2a\u6570\u636e\u6e90\u3002\u5b9a\u65f6\u67e5\u8be2\u751f\u4ea7\u7cfb\u7edf\u4f1a\u7ed9\u751f\u4ea7\u7cfb\u7edf\u6570\u636e\u5e93\u5e26\u6765\u538b\u529b\uff0c\u5f71\u54cd\u751f\u4ea7\u7cfb\u7edf\u7684\u7a33\u5b9a\u8fd0\u884c\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u9700\u8981\u5f15\u5165\u4e00\u4e2a\u53ef\u4ee5\u901a\u8fc7 ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/ververica/flink-cdc-connectors"},"Flink CDC")," \u6280\u672f\u5b9e\u73b0\u6d41\u5f0f\u5904\u7406\u7684\u6570\u4ed3\uff0c\u4ee5\u89e3\u51b3\u5b9e\u65f6\u6570\u636e\u5904\u7406\u7684\u95ee\u9898\u3002\u8fd9\u4e2a\u6570\u4ed3\u9700\u8981\u80fd\u591f\u4ece\u591a\u4e2a\u6570\u636e\u6e90\u6536\u96c6\u5b9e\u65f6\u6570\u636e\u5e76\u5728\u6b64\u57fa\u7840\u4e0a\u5b9e\u73b0\u590d\u6742\u7684\u5173\u8054 SQL \u67e5\u8be2\u3001\u673a\u5668\u5b66\u4e60\u7b49\u64cd\u4f5c\uff0c\u5e76\u4e14\u53ef\u4ee5\u907f\u514d\u4e0d\u5b9a\u65f6\u67e5\u8be2\u751f\u4ea7\u7cfb\u7edf\uff0c\u4ece\u800c\u51cf\u8f7b\u751f\u4ea7\u7cfb\u7edf\u7684\u538b\u529b\uff0c\u4fdd\u969c\u751f\u4ea7\u7cfb\u7edf\u7684\u7a33\u5b9a\u8fd0\u884c\u3002"),(0,r.kt)("h2",{id:"02-\u5927\u6570\u636e\u6280\u672f\u75db\u70b9\u4ee5\u53ca\u9009\u578b"},"02 \u5927\u6570\u636e\u6280\u672f\u75db\u70b9\u4ee5\u53ca\u9009\u578b"),(0,r.kt)("p",null,"\u6d77\u7a0b\u90a6\u8fbe\u5927\u6570\u636e\u56e2\u961f\u5efa\u7acb\u4ee5\u6765\u4e00\u76f4\u4ee5\u9ad8\u6548\u8fd0\u7ef4\u5de5\u5177\u6216\u5e73\u53f0\u6765\u5b9e\u73b0\u5bf9\u4eba\u5458\u7684\u9ad8\u6548\u914d\u7f6e\uff0c\u4f18\u5316\u91cd\u590d\u52b3\u52a8\uff0c\u624b\u5de5\u4f5c\u4e1a\u3002"),(0,r.kt)("p",null,"\u5728\u79bb\u7ebf\u6279\u6570\u5904\u7406\u5df2\u80fd\u591f\u652f\u6301\u96c6\u56e2\u57fa\u7840\u9a7e\u9a76\u8231\u548c\u7ba1\u7406\u62a5\u8868\u7684\u60c5\u51b5\u4e0b\uff0c\u96c6\u56e2\u8fd0\u7ba1\u90e8\u95e8\u63d0\u51fa\u4e86\u4e1a\u52a1\u8981\u5b9e\u65f6\u7edf\u8ba1\u8ba2\u5355\u6570\u91cf\uff0c\u64cd\u4f5c\u5355\u91cf\u7684\u9700\u6c42\uff0c\u8d22\u52a1\u90e8\u95e8\u6709\u73b0\u91d1\u6d41\u5b9e\u65f6\u5c55\u793a\u7684\u9700\u6c42\uff0c\u5728\u8fd9\u6837\u7684\u80cc\u666f\u4e0b\uff0c\u57fa\u4e8e\u5927\u6570\u636e\u7684\u6d41\u6279\u4e00\u4f53\u65b9\u6848\u52bf\u5728\u5fc5\u884c\u3002"),(0,r.kt)("p",null,"\u867d\u7136\u5927\u6570\u636e\u90e8\u95e8\u5df2\u7ecf\u4f7f\u7528\u4e86 ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/apache/doris"},"Apache Doris")," \u6765\u5b9e\u73b0\u6e56\u4ed3\u4e00\u4f53\u7684\u5b58\u50a8\u548c\u8ba1\u7b97\uff0c\u6b64\u524d\u5df2\u5728 Doris \u793e\u533a\u53d1\u8868\u6e56\u4ed3\u4e00\u4f53\u5efa\u8bbe\u7684\u6587\u7ae0\uff0c\u4f46\u662f\u6709\u4e9b\u95ee\u9898\u6709\u5f85\u89e3\u51b3\uff0c\u6d41\u5f0f\u6570\u636e\u5b58\u50a8\u65e0\u6cd5\u590d\u7528\u3001\u4e2d\u95f4\u5c42\u6570\u636e\u4e0d\u53ef\u67e5\u3001\u505a\u4e0d\u5230\u5b9e\u65f6\u805a\u5408\u8ba1\u7b97\u95ee\u9898\u3002"),(0,r.kt)("p",null,"\u6309\u7167\u67b6\u6784\u6f14\u8fdb\u65f6\u95f4\u6392\u5e8f\uff0c\u8fd1\u51e0\u5e74\u901a\u7528\u7684\u67b6\u6784\u89e3\u51b3\u65b9\u6848\u5982\u4e0b\uff1a"),(0,r.kt)("h3",{id:"hadoop\u67b6\u6784"},(0,r.kt)("strong",{parentName:"h3"},"hadoop\u67b6\u6784")),(0,r.kt)("p",null,"\u4f20\u7edf\u6570\u4ed3\u548c\u4e92\u8054\u7f51\u6570\u4ed3\u7684\u5206\u754c\u70b9\uff0c\u5728\u4e92\u8054\u7f51\u65e9\u671f\u7684\u65f6\u5019\uff0c\u5927\u5bb6\u5bf9\u4e8e\u6570\u636e\u5206\u6790\u7684\u8981\u6c42\u4e5f\u4e0d\u9ad8\uff0c\u4e3b\u8981\u662f\u505a\u5b9e\u65f6\u6027\u4e0d\u9ad8\u7684\u62a5\u8868\u3001\u652f\u6491\u51b3\u7b56\uff0c\u5bf9\u5e94\u7684\u79bb\u7ebf\u6570\u636e\u5206\u6790\u65b9\u6848\u5c31\u4ea7\u751f\u4e86\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u4f18\u70b9\uff1a"),"\u6570\u636e\u7c7b\u578b\u652f\u6301\u4e30\u5bcc\uff0c\u652f\u6301\u6d77\u91cf\u8fd0\u7b97\uff0c\u673a\u5668\u914d\u7f6e\u8981\u6c42\u4f4e\uff0c\u65f6\u6548\u6027\u4f4e\uff0c\u5bb9\u9519"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u7f3a\u70b9\uff1a"),"\u4e0d\u652f\u6301\u5b9e\u65f6\uff1b\u8fd0\u7ef4\u590d\u6742\uff1b\u67e5\u8be2\u4f18\u5316\u5668\u4e0d\u5982 MPP\uff0c\u54cd\u5e94\u6162"),(0,r.kt)("p",null,"\u9009\u578b\u4f9d\u636e\uff1a\u4e0d\u652f\u6301\u5b9e\u65f6\uff1b\u8fd0\u7ef4\u590d\u6742\uff0c\u4e0d\u7b26\u5408\u4eba\u5458\u7cbe\u7b80\u914d\u7f6e\u539f\u5219\uff1b\u6027\u80fd\u5dee"),(0,r.kt)("h3",{id:"lambda\u67b6\u6784"},(0,r.kt)("strong",{parentName:"h3"},"lambda\u67b6\u6784")),(0,r.kt)("p",null,"Lambda \u67b6\u6784\u662f\u7531 Storm \u7684\u4f5c\u8005 Nathan Marz \u63d0\u51fa\u7684\u4e00\u4e2a\u5b9e\u65f6\u5927\u6570\u636e\u5904\u7406\u6846\u67b6\u3002Marz \u5728 Twitter \u5de5\u4f5c\u671f\u95f4\u5f00\u53d1\u4e86\u8457\u540d\u7684\u5b9e\u65f6\u5927\u6570\u636e\u5904\u7406\u6846\u67b6 ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/apache/storm"},"Apache Storm")," \uff0cLambda \u67b6\u6784\u662f\u5176\u6839\u636e\u591a\u5e74\u8fdb\u884c\u5206\u5e03\u5f0f\u5927\u6570\u636e\u7cfb\u7edf\u7684\u7ecf\u9a8c\u603b\u7ed3\u63d0\u70bc\u800c\u6210\u3002"),(0,r.kt)("p",null,(0,r.kt)("img",{src:a(70896).Z,width:"764",height:"413"})),(0,r.kt)("p",null,"\u6570\u636e\u6d41\u5904\u7406\u5206\u4e3a ServingLayer\u3001SpeedLayer\u3001BatchLayer \u4e09\u5c42\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Batch\u5c42: \u5bf9\u79bb\u7ebf\u6570\u636e\u8fdb\u884c\u5904\u7406\uff0c\u6700\u540e\u63d0\u4f9b view \u670d\u52a1\u7ed9\u5230\u4e1a\u52a1\uff1b"),(0,r.kt)("li",{parentName:"ul"},"Speed\u5c42: \u5bf9\u5b9e\u65f6\u589e\u91cf\u6570\u636e\u8fdb\u884c\u5904\u7406\uff0c\u6700\u540e\u63d0\u4f9b view \u670d\u52a1\u7ed9\u5230\u4e1a\u52a1\uff1b"),(0,r.kt)("li",{parentName:"ul"},"Serving\u5c42: \u54cd\u5e94\u7528\u6237\u7684\u8bf7\u6c42\uff0c\u5b9e\u73b0\u79bb\u7ebf\u548c\u589e\u91cf\u6570\u636e\u7684\u805a\u5408\u8ba1\u7b97\uff0c\u5e76\u6700\u7ec8\u63d0\u4f9b\u670d\u52a1\uff1b")),(0,r.kt)("p",null,"\u4f18\u70b9\u662f\uff1a\u79bb\u7ebf\u548c\u5b9e\u65f6\u5206\u5f00\u8ba1\u7b97\uff0c\u4f7f\u7528\u4e24\u5957\u6846\u67b6\uff0c\u67b6\u6784\u7a33\u5b9a"),(0,r.kt)("p",null,"\u7f3a\u70b9\u662f\uff1a\u79bb\u7ebf\u548c\u5b9e\u65f6\u6570\u636e\u5f88\u96be\u4fdd\u6301\u4e00\u81f4\u6027\uff0c\u8fd0\u7ef4\u4eba\u5458\u9700\u8981\u7ef4\u62a4\u4e24\u5957\u6846\u67b6\u4e09\u5c42\u67b6\u6784\uff0c\u5f00\u53d1\u4eba\u5458\u9700\u8981\u5199\u4e09\u5957\u4ee3\u7801"),(0,r.kt)("p",null,"\u9009\u578b\u4f9d\u636e\uff1a\u6570\u636e\u4e00\u81f4\u6027\u4e0d\u53ef\u63a7\uff1b\u8fd0\u7ef4\u3001\u5f00\u53d1\u5de5\u4f5c\u91cf\u5927\uff0c\u4e0d\u7b26\u5408\u4eba\u5458\u7cbe\u7b80\u914d\u7f6e\u7684\u539f\u5219\uff1b"),(0,r.kt)("h3",{id:"kappa\u67b6\u6784"},(0,r.kt)("strong",{parentName:"h3"},"kappa\u67b6\u6784")),(0,r.kt)("p",null,"kappa \u67b6\u6784\u53ea\u7528\u4e00\u5957\u6570\u636e\u6d41\u5904\u7406\u67b6\u6784\u6765\u89e3\u51b3\u79bb\u7ebf\u548c\u5b9e\u65f6\u6570\u636e\uff0c\u7528\u5b9e\u65f6\u6d41\u6765\u89e3\u51b3\u6240\u6709\u95ee\u9898\uff0c\u65e8\u5728\u63d0\u4f9b\u5feb\u901f\u53ef\u9760\u7684\u67e5\u8be2\u8bbf\u95ee\u7ed3\u679c\u3002\u5b83\u975e\u5e38\u9002\u5408\u5404\u79cd\u6570\u636e\u5904\u7406\u5de5\u4f5c\u8d1f\u8f7d\uff0c\u5305\u62ec\u8fde\u7eed\u6570\u636e\u7ba1\u9053\u3001\u5b9e\u65f6\u6570\u636e\u5904\u7406\u3001\u673a\u5668\u5b66\u4e60\u6a21\u578b\u548c\u5b9e\u65f6\u6570\u636e\u5206\u6790\u3001\u7269\u8054\u7f51\u7cfb\u7edf\u4ee5\u53ca\u8bb8\u591a\u5176\u4ed6\u5177\u6709\u5355\u4e00\u6280\u672f\u5806\u6808\u7684\u7528\u4f8b\u3002"),(0,r.kt)("p",null,"\u5b83\u901a\u5e38\u4f7f\u7528\u6d41\u5904\u7406\u5f15\u64ce\u5b9e\u73b0\uff0c\u4f8b\u5982Apache Flink\u3001Apache Storm\u3001Apache Kinesis\u3001 Apache Kafka\uff0c\u65e8\u5728\u5904\u7406\u5927\u91cf\u6570\u636e\u6d41\u5e76\u63d0\u4f9b\u5feb\u901f\u53ef\u9760\u7684\u67e5\u8be2\u8bbf\u95ee\u7ed3\u679c\u3002"),(0,r.kt)("p",null,(0,r.kt)("img",{src:a(79263).Z,width:"1080",height:"281"})),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u4f18\u70b9\u662f\uff1a"),"\u5355\u6570\u636e\u6d41\u5904\u7406\u6846\u67b6"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u7f3a\u70b9\u662f\uff1a"),"\u867d\u7136\u5b83\u7684\u67b6\u6784\u76f8\u5bf9 lamabda \u67b6\u6784\u7b80\u5355\uff0c\u4f46\u662f\u6d41\u5f0f\u5904\u7406\u6846\u67b6\u7684\u8bbe\u7f6e\u548c\u7ef4\u62a4\u76f8\u5bf9\u590d\u6742\uff0c\u4e0d\u5177\u5907\u771f\u6b63\u610f\u4e49\u4e0a\u7684\u79bb\u7ebf\u6570\u636e\u5904\u7406\u80fd\u529b\uff1b\u6d41\u5e73\u53f0\u4e2d\u5b58\u50a8\u5927\u6570\u636e\u6210\u672c\u9ad8\u6602"),(0,r.kt)("p",null,"\u9009\u578b\u4f9d\u636e\uff1a\u79bb\u7ebf\u6570\u636e\u5904\u7406\u80fd\u529b\u9700\u8981\u4fdd\u7559\uff0c\u63a7\u5236\u6210\u672c"),(0,r.kt)("h3",{id:"iceberg"},(0,r.kt)("strong",{parentName:"h3"},"Iceberg")),(0,r.kt)("p",null,"\u4e3a\u6b64\u6211\u4eec\u4e5f\u8c03\u7814\u4e86 ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/apache/Iceberg"},"Apache Iceberg")," \uff0c\u5b83\u7684\u5feb\u7167\u529f\u80fd\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u80fd\u591f\u5b9e\u73b0\u6d41\u6279\u4e00\u4f53\uff0c\u4f46\u662f\u5b83\u7684\u95ee\u9898\u662f\u57fa\u4e8e kafka \u505a\u7684\u5b9e\u65f6\u8868\u4e2d\u95f4\u5c42\u4e0d\u53ef\u67e5\u6216\u8005\u65e0\u6cd5\u590d\u7528\u5df2\u7ecf\u5b58\u5728\u7684\u8868\uff0c\u5bf9 kafka \u6709\u5f3a\u4f9d\u8d56\uff0c\u9700\u8981\u5229\u7528 kafka \u5c06\u4e2d\u95f4\u7ed3\u679c\u5199\u5230 iceberg \u8868\uff0c\u589e\u52a0\u4e86\u7cfb\u7edf\u7684\u590d\u6742\u5ea6\u548c\u53ef\u7ef4\u62a4\u6027\u3002"),(0,r.kt)("p",null,"\u9009\u578b\u4f9d\u636e\uff1a\u65e0 kafka \u5b9e\u65f6\u67b6\u6784\u5df2\u843d\u5730\uff0c\u4e2d\u95f4\u6570\u636e\u65e0\u6cd5\u5b9e\u73b0\u53ef\u67e5\u53ef\u590d\u7528"),(0,r.kt)("h3",{id:"\u6d41\u5f0f\u6570\u4ed3kappa\u67b6\u6784\u7684\u5ef6\u7eed"},(0,r.kt)("strong",{parentName:"h3"},"\u6d41\u5f0f\u6570\u4ed3\uff08kappa\u67b6\u6784\u7684\u5ef6\u7eed)")),(0,r.kt)("p",null,"\u6d77\u7a0b\u90a6\u8fbe\u5927\u6570\u636e\u56e2\u961f\u81ea FTS0.3.0 \u7248\u672c\u5f00\u59cb\u53c2\u4e0e\u6d41\u5f0f\u6570\u4ed3\u5efa\u8bbe\uff0c\u65e8\u5728\u8fdb\u4e00\u6b65\u964d\u4f4e\u6570\u636e\u5904\u7406\u6846\u67b6\u7684\u590d\u6742\u5ea6\u548c\u4eba\u5458\u7684\u7cbe\u7b80\u914d\u7f6e\uff0c\u524d\u671f\u7684\u5b97\u65e8\u662f\u65e2\u7136\u662f\u8d8b\u52bf\u5c31\u8981\u53c2\u4e0e\u8fdb\u6765\uff0c\u8fc7\u7a0b\u4e2d\u4e0d\u65ad\u5b66\u4e60\u7cbe\u8fdb\uff0c\u5411\u6700\u524d\u6cbf\u7684\u6280\u672f\u9760\u62e2\uff0c\u56e2\u961f\u4e00\u81f4\u8ba4\u4e3a\u6709\u5751\u5c31\u8e29\u5751\uff0c\u6478\u7740\u77f3\u5934\u4e5f\u8981\u8fc7\u6cb3\uff0c\u597d\u5728\u7ecf\u8fc7\u51e0\u4e2a\u7248\u672c\u7684\u8fed\u4ee3\uff0c\u5728\u793e\u533a\u7684\u9ad8\u6548\u914d\u5408\u4e0b\uff0c\u6700\u5f00\u59cb\u51fa\u73b0\u7684\u95ee\u9898\u4e5f\u6162\u6162\u5f97\u4ee5\u89e3\u51b3"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u6d41\u5f0f\u6570\u4ed3\u67b6\u6784\u5982\u4e0b\uff1a")),(0,r.kt)("p",null,(0,r.kt)("img",{src:a(34299).Z,width:"854",height:"494"})),(0,r.kt)("p",null,"\u5ef6\u7eed\u4e86 kappa \u67b6\u6784\u7684\u7279\u70b9\uff0c\u4e00\u5957\u6d41\u5904\u7406\u67b6\u6784\uff0c\u597d\u5904\u5728\u4e0e\uff0c\u5e95\u5c42 Paimon \u7684\u6280\u672f\u652f\u6491\u4f7f\u5f97\u6570\u636e\u5728\u5168\u94fe\u8def\u53ef\u67e5\uff0c\u6570\u4ed3\u5206\u5c42\u67b6\u6784\u5f97\u4ee5\u590d\u7528\uff0c\u540c\u65f6\u517c\u987e\u4e86\u79bb\u7ebf\u548c\u5b9e\u65f6\u7684\u5904\u7406\u80fd\u529b\uff0c\u51cf\u5c11\u5b58\u50a8\u548c\u8ba1\u7b97\u7684\u6d6a\u8d39"),(0,r.kt)("h2",{id:"03-\u751f-\u4ea7-\u5b9e-\u8df5"},"03 \u751f \u4ea7 \u5b9e \u8df5"),(0,r.kt)("p",null,"\u672c\u65b9\u6848\u91c7\u7528 Flink Application On K8s \u96c6\u7fa4\uff0cFlink CDC \u5b9e\u65f6\u6444\u53d6\u4e1a\u52a1\u7cfb\u7edf\u5173\u7cfb\u578b\u6570\u636e\u5e93\u6570\u636e\uff0c\u901a\u8fc7 StreamPark \u4efb\u52a1\u5e73\u53f0\u63d0\u4ea4 Flink + Paimon Streaming Data Warehouse \u4efb\u52a1\uff0c \u6700\u540e\u91c7\u7528 Trino \u5f15\u64ce\u63a5\u5165 Finereport \u63d0\u4f9b\u670d\u52a1\u548c\u5f00\u53d1\u4eba\u5458\u7684\u67e5\u8be2\u3002Paimon \u5e95\u5c42\u5b58\u50a8\u652f\u6301 S3 \u534f\u8bae\uff0c\u56e0\u4e3a\u516c\u53f8\u5927\u6570\u636e\u670d\u52a1\u4f9d\u8d56\u4e8e\u963f\u91cc\u4e91\u6240\u4ee5\u4f7f\u7528\u5bf9\u8c61\u5b58\u50a8OSS\u4f5c\u4e3a\u6570\u636e\u6587\u4ef6\u7cfb\u7edf\u3002"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/apache/incubator-streampark"},"StreamPark")," \u662f\u4e00\u4e2a\u5b9e\u65f6\u8ba1\u7b97\u5e73\u53f0\uff0c\u4e0e ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/apache/incubator-paimon"},"Paimon")," \u7ed3\u5408\u4f7f\u7528\u5176\u5f3a\u5927\u529f\u80fd\u6765\u5904\u7406\u5b9e\u65f6\u6570\u636e\u6d41\u3002\u6b64\u5e73\u53f0\u63d0\u4f9b\u4ee5\u4e0b\u4e3b\u8981\u529f\u80fd\uff1a"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u5b9e\u65f6\u6570\u636e\u5904\u7406\uff1a"),"StreamPark \u652f\u6301\u63d0\u4ea4\u5b9e\u65f6\u6570\u636e\u6d41\u4efb\u52a1\uff0c\u80fd\u591f\u5b9e\u65f6\u83b7\u53d6\u3001\u8f6c\u6362\u3001\u8fc7\u6ee4\u548c\u5206\u6790\u6570\u636e\u3002\u8fd9\u5bf9\u4e8e\u9700\u8981\u5feb\u901f\u54cd\u5e94\u5b9e\u65f6\u6570\u636e\u7684\u5e94\u7528\u975e\u5e38\u91cd\u8981\uff0c\u4f8b\u5982\u5b9e\u65f6\u76d1\u63a7\u3001\u5b9e\u65f6\u63a8\u8350\u548c\u5b9e\u65f6\u98ce\u63a7\u7b49\u9886\u57df\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u53ef\u6269\u5c55\u6027\uff1a"),"\u53ef\u4ee5\u9ad8\u6548\u5904\u7406\u5927\u89c4\u6a21\u5b9e\u65f6\u6570\u636e\uff0c\u5177\u5907\u826f\u597d\u7684\u53ef\u6269\u5c55\u6027\u3002\u53ef\u4ee5\u5728\u5206\u5e03\u5f0f\u8ba1\u7b97\u73af\u5883\u4e2d\u8fd0\u884c\uff0c\u5e76\u80fd\u591f\u81ea\u52a8\u5904\u7406\u5e76\u884c\u5316\u3001\u6545\u969c\u6062\u590d\u548c\u8d1f\u8f7d\u5747\u8861\u7b49\u95ee\u9898\uff0c\u4ee5\u786e\u4fdd\u9ad8\u6548\u4e14\u53ef\u9760\u5730\u5904\u7406\u6570\u636e\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Flink \u96c6\u6210\uff1a"),"\u57fa\u4e8e ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/apache/flink"},"Apache Flink")," \u6784\u5efa\uff0c\u5229\u7528 Flink \u7684\u5f3a\u5927\u6d41\u5904\u7406\u5f15\u64ce\u6765\u5b9e\u73b0\u9ad8\u6027\u80fd\u548c\u9c81\u68d2\u6027\u3002\u7528\u6237\u53ef\u4ee5\u5145\u5206\u5229\u7528 Flink \u7684\u7279\u6027\u548c\u751f\u6001\u7cfb\u7edf\uff0c\u5982\u5e7f\u6cdb\u7684\u8fde\u63a5\u5668\u3001\u72b6\u6001\u7ba1\u7406\u548c\u4e8b\u4ef6\u65f6\u95f4\u5904\u7406\u7b49\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u6613\u7528\u6027\uff1a"),"\u63d0\u4f9b\u4e86\u76f4\u89c2\u7684\u56fe\u5f62\u754c\u9762\u548c\u7b80\u5316\u7684 API\uff0c\u53ef\u4ee5\u8f7b\u677e\u5730\u6784\u5efa\u548c\u90e8\u7f72\u6570\u636e\u5904\u7406\u4efb\u52a1\uff0c\u800c\u65e0\u9700\u6df1\u5165\u4e86\u89e3\u5e95\u5c42\u6280\u672f\u7ec6\u8282\u3002"),(0,r.kt)("p",null,"\u901a\u8fc7\u5728 StreamPark \u5e73\u53f0\u4e0a\u63d0\u4ea4 Paimon \u4efb\u52a1\uff0c\u6211\u4eec\u53ef\u4ee5\u5efa\u7acb\u4e00\u4e2a\u5168\u94fe\u8def\u5b9e\u65f6\u6d41\u52a8\u3001\u53ef\u67e5\u8be2\u548c\u5206\u5c42\u53ef\u590d\u7528\u7684 Pipline\u3002"),(0,r.kt)("p",null,(0,r.kt)("img",{src:a(58851).Z,width:"1080",height:"496"})),(0,r.kt)("p",null,"\u4e3b\u8981\u91c7\u7528\u7ec4\u4ef6\u7248\u672c\u5982\u4e0b\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"flink-1.16.0-scala-2.12"),(0,r.kt)("li",{parentName:"ul"},"paimon-flink-1.16-0.4-20230424.001927-40.jar"),(0,r.kt)("li",{parentName:"ul"},"apache-streampark_2.12-2.0.0"),(0,r.kt)("li",{parentName:"ul"},"kubernetes v1.18.3")),(0,r.kt)("h3",{id:"\u73af\u5883\u6784\u5efa"},(0,r.kt)("strong",{parentName:"h3"},"\u73af\u5883\u6784\u5efa")),(0,r.kt)("p",null,"\u4e0b\u8f7d flink-1.16.0-scala-2.12.tar.gz \u53ef\u4ee5\u5728 flink\u5b98\u7f51 \u4e0b\u8f7d\u5bf9\u5e94\u7248\u672c\u7684\u5b89\u88c5\u5305\u5230StreamPark \u90e8\u7f72\u670d\u52a1\u5668"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"#\u89e3\u538b\ntar zxvf flink-1.16.0-scala-2.12.tar.gz\n\n#\u4fee\u6539 flink-conf \u914d\u7f6e\u6587\u4ef6\u5e76\u542f\u52a8\u96c6\u7fa4\n\njobmanager.rpc.address: localhost\njobmanager.rpc.port: 6123\njobmanager.bind-host: localhost\njobmanager.memory.process.size: 4096m\ntaskmanager.bind-host: localhost\ntaskmanager.host: localhost\ntaskmanager.memory.process.size: 4096m\ntaskmanager.numberOfTaskSlots: 4\nparallelism.default: 4\nakka.ask.timeout: 100s\nweb.timeout: 1000000\n\n#checkpoints&&savepoints\nstate.checkpoints.dir: file:///opt/flink/checkpoints\nstate.savepoints.dir: file:///opt/flink/savepoints\nexecution.checkpointing.interval: 2min\n\n#\u5f53\u4f5c\u4e1a\u624b\u52a8\u53d6\u6d88/\u6682\u505c\u65f6\uff0c\u5c06\u4f1a\u4fdd\u7559\u4f5c\u4e1a\u7684 Checkpoint \u72b6\u6001\u4fe1\u606f\nexecution.checkpointing.externalized-checkpoint-retention: RETAIN_ON_CANCELLATION\nstate.backend: rocksdb\n\n#\u5df2\u5b8c\u6210\u7684CP\u4fdd\u5b58\u4e2a\u6570\nstate.checkpoints.num-retained: 2000\nstate.backend.incremental: true\nexecution.checkpointing.checkpoints-after-tasks-finish.enabled: true\n\n#OSS\nfs.oss.endpoint: oss-cn-zhangjiakou-internal.aliyuncs.com\nfs.oss.accessKeyId: xxxxxxxxxxxxxxxxxxxxxxx\nfs.oss.accessKeySecret: xxxxxxxxxxxxxxxxxxxxxxx\nfs.oss.impl: org.apache.hadoop.fs.aliyun.oss.AliyunOSSFileSystem\njobmanager.execution.failover-strategy: region\nrest.port: 8081\nrest.address: localhost\n")),(0,r.kt)("p",null,"\u5efa\u8bae\u53ef\u4ee5\u5728\u672c\u5730\u6dfb\u52a0 FLINK_HOME \u65b9\u4fbf\u5728\u4e0a k8s \u4e4b\u524d\u672c\u5730\u6392\u67e5\u95ee\u9898\u4f7f\u7528"),(0,r.kt)("p",null,"vim /etc/profile"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"#FLINK\nexport FLINK_HOME=/data/src/flink-1.16.0-scala-2.12\nexport PATH=$PATH:$FLINK_HOME/bin\nsource /etc/profile\n")),(0,r.kt)("p",null,"\u5728 StreamPark \u6dfb\u52a0 Flink conf:"),(0,r.kt)("p",null,(0,r.kt)("img",{src:a(85186).Z,width:"1080",height:"427"})),(0,r.kt)("p",null,"\u6784\u5efa Flink 1.16.0 \u57fa\u7840\u955c\u50cf\u4ece dockerhub\u62c9\u53d6\u5bf9\u5e94\u7248\u672c\u7684\u955c\u50cf"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-dockerfile"},"#\u62c9\u53d6\u955c\u50cf\ndocker pull flink:1.16.0-scala_2.12-java8\n\n#\u6253\u4e0a tag\ndocker tagflink:1.16.0-scala_2.12-java8  registry-vpc.cn-zhangjiakou.aliyuncs.com/xxxxx/flink:1.16.0-scala_2.12-java8\n\n#push \u5230\u516c\u53f8\u4ed3\u5e93\ndocker pushregistry-vpc.cn-zhangjiakou.aliyuncs.com/xxxxx/flink:1.16.0-scala_2.12-java8\n")),(0,r.kt)("p",null,"\u521b\u5efa Dockerfile \u6587\u4ef6 & target \u76ee\u5f55\u5c06 flink-oss-fs-hadoop JAR\u5305\u653e\u7f6e\u5728\u8be5\u76ee\u5f55 Shaded Hadoop OSS file system jar \u5305\u4e0b\u8f7d\u5730\u5740\uff1a"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://repository.apache.org/snapshots/org/apache/paimon/paimon-oss/"},"https://repository.apache.org/snapshots/org/apache/paimon/paimon-oss/")),(0,r.kt)("p",null,"."),(0,r.kt)("p",null,"\u251c\u2500\u2500 Dockerfile"),(0,r.kt)("p",null,"\u2514\u2500\u2500 target"),(0,r.kt)("p",null," \u2514\u2500\u2500 flink-oss-fs-hadoop-1.16.0.jar"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"touch Dockerfile\n\nmkdir target\n\n#vim Dockerfile\nFROM registry-vpc.cn-zhangjiakou.aliyuncs.com/xxxxx/flink:1.16.0-scala_2.12-java8\n\nRUN mkdir /opt/flink/plugins/oss-fs-hadoop\n\nCOPY target/flink-oss-fs-hadoop-1.16.0.jar  /opt/flink/plugins/oss-fs-hadoop\n")),(0,r.kt)("h3",{id:"build-\u57fa\u7840\u955c\u50cf"},(0,r.kt)("strong",{parentName:"h3"},"build \u57fa\u7840\u955c\u50cf")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"docker build -t flink-table-store:v1.16.0 .\n\ndocker tag flink-table-store:v1.16.0 registry-vpc.cn-zhangjiakou.aliyuncs.com/xxxxx/flink-table-store:v1.16.0\n\ndocker push registry-vpc.cn-zhangjiakou.aliyuncs.com/xxxxx/flink-table-store:v1.16.0\n")),(0,r.kt)("p",null,"\u63a5\u4e0b\u6765\u51c6\u5907 Paimon jar \u5305\uff0c\u53ef\u4ee5\u5728 Apache ",(0,r.kt)("a",{parentName:"p",href:"https://repository.apache.org/content/groups/snapshots/org/apache/paimon"},"Repository")," \u4e0b\u8f7d\u5bf9\u5e94\u7248\u672c\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\u8981\u548c flink \u5927\u7248\u672c\u4fdd\u6301\u4e00\u81f4"),(0,r.kt)("h3",{id:"\u4f7f\u7528-streampark-\u7ba1\u7406\u4f5c\u4e1a"},(0,r.kt)("strong",{parentName:"h3"},"\u4f7f\u7528 StreamPark \u7ba1\u7406\u4f5c\u4e1a")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u524d\u63d0\u6761\u4ef6\uff1a")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Kubernetes \u5ba2\u6237\u7aef\u8fde\u63a5\u914d\u7f6e"),(0,r.kt)("li",{parentName:"ul"},"Kubernetes RBAC \u914d\u7f6e"),(0,r.kt)("li",{parentName:"ul"},"\u5bb9\u5668\u955c\u50cf\u4ed3\u5e93\u914d\u7f6e \uff08\u6848\u4f8b\u4e2d\u4f7f\u7528\u7684\u662f\u963f\u91cc\u4e91\u955c\u50cf\u514d\u8d39\u7248\uff09"),(0,r.kt)("li",{parentName:"ul"},"\u521b\u5efa\u6302\u8f7d checkpoint/savepoint \u7684 pvc \u8d44\u6e90")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Kubernetes \u5ba2\u6237\u7aef\u8fde\u63a5\u914d\u7f6e\uff1a")),(0,r.kt)("p",null,"\u5c06 k8s master\u8282\u70b9~/.kube/config \u914d\u7f6e\u76f4\u63a5\u62f7\u8d1d\u5230 StreamPark \u670d\u52a1\u5668\u7684\u76ee\u5f55\uff0c\u4e4b\u540e\u5728 StreamPark \u670d\u52a1\u5668\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u663e\u793a k8s \u96c6\u7fa4 running \u4ee3\u8868\u6743\u9650\u548c\u7f51\u7edc\u9a8c\u8bc1\u6210\u529f\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"kubectl cluster-info\n")),(0,r.kt)("p",null,"Kubernetes RBAC \u914d\u7f6e,\u521b\u5efa streampark \u547d\u540d\u7a7a\u95f4:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"kubectl create ns streampark\n")),(0,r.kt)("p",null,"\u4f7f\u7528 default \u8d26\u6237\u521b\u5efa clusterrolebinding \u8d44\u6e90:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"kubectl create secret docker-registry streamparksecret \n--docker-server=registry-vpc.cn-zhangjiakou.aliyuncs.com \n--docker-username=xxxxxx \n--docker-password=xxxxxx -n streampark```\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u5bb9\u5668\u955c\u50cf\u4ed3\u5e93\u914d\u7f6e:")),(0,r.kt)("p",null,"\u6848\u4f8b\u4e2d\u4f7f\u7528\u963f\u91cc\u4e91\u5bb9\u5668\u955c\u50cf\u670d\u52a1ACR\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u81ea\u5efa\u955c\u50cf\u670d\u52a1harbor\u4ee3\u66ff\u3002"),(0,r.kt)("p",null,"\u521b\u5efa\u547d\u540d\u7a7a\u95f4 StreamPark (\u5b89\u5168\u8bbe\u7f6e\u9700\u8981\u8bbe\u7f6e\u4e3a\u79c1\u6709)"),(0,r.kt)("p",null,(0,r.kt)("img",{src:a(1183).Z,width:"1080",height:"316"})),(0,r.kt)("p",null,"\u5728 StreamPark \u914d\u7f6e\u955c\u50cf\u4ed3\u5e93\uff0c\u4efb\u52a1\u6784\u5efa\u955c\u50cf\u4f1a\u63a8\u9001\u5230\u955c\u50cf\u4ed3\u5e93"),(0,r.kt)("p",null,(0,r.kt)("img",{src:a(86466).Z,width:"1080",height:"360"})),(0,r.kt)("p",null,"\u521b\u5efa k8s secret \u5bc6\u94a5\u7528\u6765\u62c9\u53d6 ACR \u4e2d\u7684\u955c\u50cf streamparksecret \u4e3a\u5bc6\u94a5\u540d\u79f0 \u81ea\u5b9a\u4e49"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"kubectl create secret docker-registry streamparksecret \n--docker-server=registry-vpc.cn-zhangjiakou.aliyuncs.com \n--docker-username=xxxxxx \n--docker-password=xxxxxx -n streampark\n")),(0,r.kt)("p",null,"\u521b\u5efa\u6302\u8f7d checkpoint/savepoint \u7684 pvc \u8d44\u6e90\uff0c\u57fa\u4e8e\u963f\u91cc\u4e91\u7684\u5bf9\u8c61\u5b58\u50a8OSS\u505aK8S\u7684\u6301\u4e45\u5316"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"OSS CSI \u63d2\u4ef6\uff1a")),(0,r.kt)("p",null,"\u53ef\u4ee5\u4f7f\u7528 OSS CSI \u63d2\u4ef6\u6765\u5e2e\u52a9\u7b80\u5316\u5b58\u50a8\u7ba1\u7406\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528 csi \u914d\u7f6e\u521b\u5efa pv\uff0c\u5e76\u4e14 pvc\u3001pod \u50cf\u5f80\u5e38\u4e00\u6837\u5b9a\u4e49\uff0cyaml \u6587\u4ef6\u53c2\u8003\uff1a\n",(0,r.kt)("a",{parentName:"p",href:"https://bondextest.oss-cn-zhangjiakou.aliyuncs.com/ossyaml.zip"},"https://bondextest.oss-cn-zhangjiakou.aliyuncs.com/ossyaml.zip")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u914d\u7f6e\u8981\u6c42\uff1a")),(0,r.kt)("p",null,"-"," \u521b\u5efa\u5177\u6709\u6240\u9700 RBAC \u6743\u9650\u7684\u670d\u52a1\u5e10\u6237\uff0c\u53c2\u8003\uff1a"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/kubernetes-sigs/alibaba-cloud-csi-driver/blob/master/docs/oss.md"},"https://github.com/kubernetes-sigs/alibaba-cloud-csi-driver/blob/master/docs/oss.md")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"kubectl -f rbac.yaml\n")),(0,r.kt)("p",null,"-"," \u90e8\u7f72OSS CSI \u63d2\u4ef6"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"kubectl -f oss-plugin.yaml\n")),(0,r.kt)("p",null,"-"," \u521b\u5efa CP&SP \u7684 PV"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"kubectl -f checkpoints_pv.yaml kubectl -f savepoints_pv.yaml\n")),(0,r.kt)("p",null,"-"," \u521b\u5efa CP&SP \u7684 PVC"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"kubectl -f checkpoints_pvc.yaml kubectl -f savepoints_pvc.yaml\n")),(0,r.kt)("p",null,"\u914d\u7f6e\u597d\u4f9d\u8d56\u73af\u5883\uff0c\u63a5\u4e0b\u6765\u6211\u4eec\u5c31\u5f00\u59cb\u4f7f\u7528 Paimon \u8fdb\u884c\u6d41\u5f0f\u6570\u4ed3\u7684\u5206\u5c42\u5f00\u53d1\u3002"),(0,r.kt)("h3",{id:"\u6848\u4f8b"},(0,r.kt)("strong",{parentName:"h3"},"\u6848\u4f8b")),(0,r.kt)("p",null,"\u7edf\u8ba1\u6d77\u8fd0\u7a7a\u8fd0\u5b9e\u65f6\u59d4\u6258\u5355\u91cf"),(0,r.kt)("p",null,"\u4efb\u52a1\u63d0\u4ea4\uff1a\u521d\u59cb\u5316 Paimon catalog \u914d\u7f6e"),(0,r.kt)("p",null,(0,r.kt)("img",{src:a(22276).Z,width:"592",height:"637"})),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"SET 'execution.runtime-mode' = 'streaming';\nset 'table.exec.sink.upsert-materialize' = 'none';\nSET 'sql-client.execution.result-mode' = 'tableau';\n-- \u521b\u5efa\u5e76\u4f7f\u7528 FTS Catalog \u5e95\u5c42\u5b58\u50a8\u65b9\u6848\u91c7\u7528\u963f\u91cc\u4e91oss\nCREATE CATALOG `table_store` WITH (\n'type' = 'paimon',\n'warehouse' = 'oss://xxxxx/xxxxx' #\u81ea\u5b9a\u4e49oss\u5b58\u50a8\u8def\u5f84\n);\nUSE CATALOG `table_store`;\n")),(0,r.kt)("p",null,"\u4e00\u4e2a\u4efb\u52a1\u540c\u65f6\u62bd\u53d6 postgres\u3001mysql\u3001sqlserver \u4e09\u79cd\u6570\u636e\u5e93\u7684\u8868\u6570\u636e\u5199\u5165\u5230 Paimon"),(0,r.kt)("p",null,(0,r.kt)("img",{src:a(6169).Z,width:"1080",height:"533"})),(0,r.kt)("p",null,(0,r.kt)("img",{src:a(81275).Z,width:"1080",height:"597"})),(0,r.kt)("p",null,(0,r.kt)("img",{src:a(32295).Z,width:"1080",height:"623"})),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u4fe1\u606f\u5982\u4e0b:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"Development Mode\uff1aFlink SQL\n\nExecution Mode \uff1akubernetes application\n\nFlink Version \uff1aflink-1.16.0-scala-2.12\n\nKubernetes Namespace \uff1astreampark\n\nKubernetes ClusterId \uff1a\uff08\u4efb\u52a1\u540d\u81ea\u5b9a\u4e49\u5373\u53ef\uff09\n\n#\u4e0a\u4f20\u5230\u963f\u91cc\u4e91\u955c\u50cf\u4ed3\u5e93\u7684\u57fa\u7840\u955c\u50cf\nFlink Base Docker Image \uff1aregistry-vpc.cn-zhangjiakou.aliyuncs.com/xxxxx/flink-table-store:v1.16.0\n\nRest-Service Exposed Type\uff1aNodePort\n\n#paimon\u57fa\u7840\u4f9d\u8d56\u5305\uff1a\n\npaimon-flink-1.16-0.4-20230424.001927-40.jar\n\nflink-shaded-hadoop-2-uber-2.8.3-10.0.jar\n\n#flinkcdc\u4f9d\u8d56\u5305\u4e0b\u8f7d\u5730\u5740\uff1a\n\nhttps://github.com/ververica/flink-cdc-connectors/releases/tag/release-2.2.0\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"pod template:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"apiVersion: v1\nkind: Pod\nmetadata:\nname: pod-template\nspec:\n\ncontainers:\n  - name: flink-main-container\n    volumeMounts:\n      - name: flink-checkpoints-csi-pvc\n        mountPath: /opt/flink/checkpoints\n      - name: flink-savepoints-csi-pvc\n        mountPath: /opt/flink/savepoints\n\nvolumes:\n  - name: flink-checkpoints-csi-pvc\n    persistentVolumeClaim:\n      claimName: flink-checkpoints-csi-pvc\n  - name: flink-savepoints-csi-pvc\n    persistentVolumeClaim:\n      claimName: flink-savepoints-csi-pvc\n\nimagePullSecrets:\n- name: streamparksecret\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Flink sql\uff1a")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u6784\u5efa\u6e90\u8868\u548cpaimon\u4e2dods\u8868\u7684\u5173\u7cfb\uff0c\u8fd9\u91cc\u5c31\u662f\u6e90\u8868\u548c\u76ee\u6807\u8868\u4e00\u5bf9\u4e00\u6620\u5c04")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"-- postgre\u6570\u636e\u5e93 \u793a\u4f8b\nCREATE TEMPORARY TABLE `shy_doc_hdworkdochd` (\n`doccode` varchar(50) not null COMMENT '\u4e3b\u952e',\n`businessmodel` varchar(450) COMMENT '\u4e1a\u52a1\u6a21\u5f0f',\n`businesstype` varchar(450)  COMMENT '\u4e1a\u52a1\u6027\u8d28',\n`transporttype` varchar(50) COMMENT '\u8fd0\u8f93\u7c7b\u578b',\n......\n`bookingguid` varchar(50) COMMENT '\u64cd\u4f5c\u7f16\u53f7',\nPRIMARY KEY (`doccode`) NOT ENFORCED\n) WITH (\n'connector' = 'postgres-cdc',\n'hostname' = '\u6570\u636e\u5e93\u670d\u52a1\u5668IP\u5730\u5740',\n'port' = '\u7aef\u53e3\u53f7',\n'username' = '\u7528\u6237\u540d',\n'password' = '\u5bc6\u7801',\n'database-name' = '\u6570\u636e\u5e93\u540d',\n'schema-name' = 'dev',\n'decoding.plugin.name' = 'wal2json',,\n'table-name' = 'doc_hdworkdochd',\n'debezium.slot.name' = 'hdworkdochdslotname03'\n);\n\nCREATE TEMPORARY TABLE `shy_base_enterprise` (\n`entguid` varchar(50) not null COMMENT '\u4e3b\u952e',\n`entorgcode` varchar(450) COMMENT '\u5ba2\u6237\u7f16\u53f7',\n`entnature` varchar(450)  COMMENT '\u5ba2\u6237\u7c7b\u578b',\n`entfullname` varchar(50) COMMENT '\u5ba2\u6237\u540d\u79f0',\nPRIMARY KEY (`entguid`,`entorgcode`) NOT ENFORCED\n) WITH (\n'connector' = 'postgres-cdc',\n'hostname' = '\u6570\u636e\u5e93\u670d\u52a1\u5668IP\u5730\u5740',\n'port' = '\u7aef\u53e3\u53f7',\n'username' = '\u7528\u6237\u540d',\n'password' = '\u5bc6\u7801',\n'database-name' = '\u6570\u636e\u5e93\u540d',\n'schema-name' = 'dev',\n'decoding.plugin.name' = 'wal2json',\n'table-name' = 'base_enterprise',\n'debezium.snapshot.mode'='never', -- \u589e\u91cf\u540c\u6b65(\u5168\u91cf+\u589e\u91cf\u5ffd\u7565\u8be5\u5c5e\u6027)\n'debezium.slot.name' = 'base_enterprise_slotname03'\n);\n\n-- \u6839\u636e\u6e90\u8868\u7ed3\u6784\u5728paimon\u4e0aods\u5c42\u521b\u5efa\u5bf9\u5e94\u7684\u76ee\u6807\u8868\nCREATE TABLE IF NOT EXISTS ods.`ods_shy_jh_doc_hdworkdochd` (\n`o_year` BIGINT NOT NULL COMMENT '\u5206\u533a\u5b57\u6bb5',\n`create_date` timestamp NOT NULL COMMENT '\u521b\u5efa\u65f6\u95f4',\nPRIMARY KEY (`o_year`, `doccode`) NOT ENFORCED\n) PARTITIONED BY (`o_year`)\nWITH (\n'changelog-producer.compaction-interval' = '2m'\n) LIKE `shy_doc_hdworkdochd` (EXCLUDING CONSTRAINTS EXCLUDING OPTIONS);\nCREATE TABLE IF NOT EXISTS ods.`ods_shy_base_enterprise` (\n`create_date` timestamp NOT NULL COMMENT '\u521b\u5efa\u65f6\u95f4',\nPRIMARY KEY (`entguid`,`entorgcode`) NOT ENFORCED\n)\nWITH (\n'changelog-producer.compaction-interval' = '2m'\n) LIKE `shy_base_enterprise` (EXCLUDING CONSTRAINTS EXCLUDING OPTIONS);\n\n-- \u8bbe\u7f6e\u4f5c\u4e1a\u540d\uff0c\u6267\u884c\u4f5c\u4e1a\u4efb\u52a1\u5c06\u6e90\u8868\u6570\u636e\u5b9e\u65f6\u5199\u5165\u5230paimon\u5bf9\u5e94\u8868\u4e2d\nSET 'pipeline.name' = 'ods_doc_hdworkdochd';\nINSERT INTO\nods.`ods_shy_jh_doc_hdworkdochd`\nSELECT\n*\n,YEAR(`docdate`) AS `o_year`\n,TO_TIMESTAMP(CONVERT_TZ(cast(CURRENT_TIMESTAMP as varchar), 'UTC', 'Asia/Shanghai')) AS `create_date`\nFROM\n`shy_doc_hdworkdochd` where `docdate` is not null and `docdate` > '2023-01-01';\nSET 'pipeline.name' = 'ods_shy_base_enterprise';\nINSERT INTO\nods.`ods_shy_base_enterprise`\nSELECT\n*\n,TO_TIMESTAMP(CONVERT_TZ(cast(CURRENT_TIMESTAMP as varchar), 'UTC', 'Asia/Shanghai')) AS `create_date`\nFROM\n`shy_base_enterprise` where entorgcode is not null and entorgcode <> '';\n\n-- mysql\u6570\u636e\u5e93 \u793a\u4f8b\nCREATE TEMPORARY TABLE `doc_order` (\n`id` BIGINT NOT NULL COMMENT '\u4e3b\u952e',\n`order_no` varchar(50) NOT NULL COMMENT '\u8ba2\u5355\u53f7',\n`business_no` varchar(50) COMMENT 'OMS\u670d\u52a1\u53f7',\n......\n`is_deleted` int COMMENT '\u662f\u5426\u4f5c\u5e9f',\nPRIMARY KEY (`id`) NOT ENFORCED\n) WITH (\n'connector' = 'mysql-cdc',\n'hostname' = '\u6570\u636e\u5e93\u670d\u52a1\u5668\u5730\u5740',\n'port' = '\u7aef\u53e3\u53f7',\n'username' = '\u7528\u6237\u540d',\n'password' = '\u5bc6\u7801',\n'database-name' = '\u5e93\u540d',\n'table-name' = 'doc_order'\n);\n\n-- \u6839\u636e\u6e90\u8868\u7ed3\u6784\u5728paimon\u4e0aods\u5c42\u521b\u5efa\u5bf9\u5e94\u7684\u76ee\u6807\u8868\nCREATE TABLE IF NOT EXISTS ods.`ods_bondexsea_doc_order` (\n`o_year` BIGINT NOT NULL COMMENT '\u5206\u533a\u5b57\u6bb5',\n`create_date` timestamp NOT NULL COMMENT '\u521b\u5efa\u65f6\u95f4',\nPRIMARY KEY (`o_year`, `id`) NOT ENFORCED\n) PARTITIONED BY (`o_year`)\nWITH (\n'changelog-producer.compaction-interval' = '2m'\n) LIKE `doc_order` (EXCLUDING CONSTRAINTS EXCLUDING OPTIONS);\n\n-- \u8bbe\u7f6e\u4f5c\u4e1a\u540d\uff0c\u6267\u884c\u4f5c\u4e1a\u4efb\u52a1\u5c06\u6e90\u8868\u6570\u636e\u5b9e\u65f6\u5199\u5165\u5230paimon\u5bf9\u5e94\u8868\u4e2d\nSET 'pipeline.name' = 'ods_bondexsea_doc_order';\nINSERT INTO\nods.`ods_bondexsea_doc_order`\nSELECT\n*\n,YEAR(`gmt_create`) AS `o_year`\n,TO_TIMESTAMP(CONVERT_TZ(cast(CURRENT_TIMESTAMP as varchar), 'UTC', 'Asia/Shanghai')) AS `create_date`\nFROM `doc_order` where gmt_create > '2023-01-01';\n\n-- sqlserver\u6570\u636e\u5e93 \u793a\u4f8b\nCREATE TEMPORARY TABLE `OrderHAWB` (\n`HBLIndex` varchar(50) NOT NULL COMMENT '\u4e3b\u952e',\n`CustomerNo` varchar(50) COMMENT '\u5ba2\u6237\u7f16\u53f7',\n......\n`CreateOPDate` timestamp COMMENT '\u5236\u5355\u65e5\u671f',\nPRIMARY KEY (`HBLIndex`) NOT ENFORCED\n) WITH (\n'connector' = 'sqlserver-cdc',\n'hostname' = '\u6570\u636e\u5e93\u670d\u52a1\u5668\u5730\u5740',\n'port' = '\u7aef\u53e3\u53f7',\n'username' = '\u7528\u6237\u540d',\n'password' = '\u5bc6\u7801',\n'database-name' = '\u6570\u636e\u5e93\u540d',\n'schema-name' = 'dbo',\n-- 'debezium.snapshot.mode' = 'initial' -- \u5168\u91cf\u589e\u91cf\u90fd\u62bd\u53d6\n'scan.startup.mode' = 'latest-offset',-- \u53ea\u62bd\u53d6\u589e\u91cf\u6570\u636e\n'table-name' = 'OrderHAWB'\n);\n\n-- \u6839\u636e\u6e90\u8868\u7ed3\u6784\u5728paimon\u4e0aods\u5c42\u521b\u5efa\u5bf9\u5e94\u7684\u76ee\u6807\u8868\nCREATE TABLE IF NOT EXISTS ods.`ods_airsea_airfreight_orderhawb` (\n`o_year` BIGINT NOT NULL COMMENT '\u5206\u533a\u5b57\u6bb5',\n`create_date` timestamp NOT NULL COMMENT '\u521b\u5efa\u65f6\u95f4',\nPRIMARY KEY (`o_year`, `HBLIndex`) NOT ENFORCED\n) PARTITIONED BY (`o_year`)\nWITH (\n'changelog-producer.compaction-interval' = '2m'\n) LIKE `OrderHAWB` (EXCLUDING CONSTRAINTS EXCLUDING OPTIONS);\n\n-- \u8bbe\u7f6e\u4f5c\u4e1a\u540d\uff0c\u6267\u884c\u4f5c\u4e1a\u4efb\u52a1\u5c06\u6e90\u8868\u6570\u636e\u5b9e\u65f6\u5199\u5165\u5230paimon\u5bf9\u5e94\u8868\u4e2d\nSET 'pipeline.name' = 'ods_airsea_airfreight_orderhawb';\nINSERT INTO\nods.`ods_airsea_airfreight_orderhawb`\nSELECT\nRTRIM(`HBLIndex`) as `HBLIndex`\n......\n,`CreateOPDate`\n,YEAR(`CreateOPDate`) AS `o_year`\n,TO_TIMESTAMP(CONVERT_TZ(cast(CURRENT_TIMESTAMP as varchar), 'UTC', 'Asia/Shanghai')) AS `create_date`\nFROM `OrderHAWB` where CreateOPDate > '2023-01-01';\n")),(0,r.kt)("p",null,"\u4e1a\u52a1\u8868\u6570\u636e\u5b9e\u65f6\u5199\u5165 Paimon ods \u8868\u6548\u679c\u5982\u4e0b\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{src:a(60002).Z,width:"1080",height:"422"})),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},"\u5c06ods\u5c42\u8868\u7684\u6570\u636e\u6253\u5bbd\u5199\u5165 dwd \u5c42\u4e2d\uff0c\u8fd9\u91cc\u5176\u5b9e\u5c31\u662f\u5c06 ods \u5c42\u76f8\u5173\u4e1a\u52a1\u8868\u5408\u5e76\u5199\u5165dwd \u4e2d\uff0c\u8fd9\u91cc\u4e3b\u8981\u662f\u5904\u7406 count_order \u5b57\u6bb5\u7684\u503c\uff0c\u56e0\u4e3a\u6e90\u8868\u4e2d\u7684\u6570\u636e\u5b58\u5728\u903b\u8f91\u5220\u9664\u548c\u7269\u7406\u5220\u9664\u6240\u4ee5\u901a\u8fc7 count \u51fd\u6570\u7edf\u8ba1\u4f1a\u6709\u95ee\u9898\uff0c\u6240\u4ee5\u6211\u4eec\u8fd9\u91cc\u91c7\u7528 sum \u805a\u5408\u6765\u8ba1\u7b97\u5355\u91cf\uff0c\u6bcf\u4e2areference_no\u5bf9\u5e94\u7684count_order\u662f1\uff0c\u5982\u679c\u903b\u8f91\u4f5c\u5e9f\u901a\u8fc7sql\u5c06\u5b83\u5904\u7406\u62100\uff0c\u7269\u7406\u5220\u9664 Paimon \u4f1a\u81ea\u52a8\u5904\u7406\u3002")),(0,r.kt)("p",null,"dim \u7ef4\u8868\u6211\u4eec\u8fd9\u8fb9\u76f4\u63a5\u62ff\u7684 doris \u91cc\u9762\u5904\u7406\u597d\u7684\u7ef4\u8868\u6765\u4f7f\u7528\uff0c\u7ef4\u8868\u66f4\u65b0\u9891\u7387\u4f4e\uff0c\u6240\u4ee5\u6ca1\u6709\u5728 Paimon \u91cc\u9762\u8fdb\u884c\u4e8c\u6b21\u5f00\u53d1\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"-- \u5728paimon-dwd\u5c42\u521b\u5efa\u5bbd\u8868\nCREATE TABLE IF NOT EXISTS dwd.`dwd_business_order` (\n`reference_no` varchar(50) NOT NULL COMMENT '\u59d4\u6258\u5355\u53f7\u4e3b\u952e',\n`bondex_shy_flag` varchar(8) NOT NULL COMMENT '\u533a\u5206',\n`is_server_item` int NOT NULL COMMENT '\u662f\u5426\u5df2\u7ecf\u5173\u8054\u8ba2\u5355',\n`order_type_name` varchar(50) NOT NULL COMMENT '\u4e1a\u52a1\u5206\u7c7b',\n`consignor_date` DATE COMMENT '\u7edf\u8ba1\u65e5\u671f',\n`consignor_code` varchar(50) COMMENT '\u5ba2\u6237\u7f16\u53f7',\n`consignor_name` varchar(160) COMMENT '\u5ba2\u6237\u540d\u79f0',\n`sales_code` varchar(32) NOT NULL COMMENT '\u9500\u552e\u7f16\u53f7',\n`sales_name` varchar(200) NOT NULL COMMENT '\u9500\u552e\u540d\u79f0',\n`delivery_center_op_id` varchar(32) NOT NULL COMMENT '\u4ea4\u4ed8\u7f16\u53f7',\n`delivery_center_op_name` varchar(200) NOT NULL COMMENT '\u4ea4\u4ed8\u540d\u79f0',\n`pol_code` varchar(100) NOT NULL COMMENT '\u8d77\u8fd0\u6e2f\u4ee3\u7801',\n`pot_code` varchar(100) NOT NULL COMMENT '\u4e2d\u8f6c\u6e2f\u4ee3\u7801',\n`port_of_dest_code` varchar(100) NOT NULL  COMMENT '\u76ee\u7684\u6e2f\u4ee3\u7801',\n`is_delete` int not NULL COMMENT '\u662f\u5426\u4f5c\u5e9f',\n`order_status` varchar(8) NOT NULL COMMENT '\u8ba2\u5355\u72b6\u6001',\n`count_order` BIGINT not NULL COMMENT '\u8ba2\u5355\u6570',\n`o_year` BIGINT NOT NULL COMMENT '\u5206\u533a\u5b57\u6bb5',\n`create_date` timestamp NOT NULL COMMENT '\u521b\u5efa\u65f6\u95f4',\nPRIMARY KEY (`o_year`,`reference_no`,`bondex_shy_flag`) NOT ENFORCED\n) PARTITIONED BY (`o_year`)\nWITH (\n-- \u6bcf\u4e2a partition \u4e0b\u8bbe\u7f6e 2 \u4e2a bucket\n'bucket' = '2',\n'changelog-producer' = 'full-compaction',\n'snapshot.time-retained' = '2h',\n'changelog-producer.compaction-interval' = '2m'\n);\n\n-- \u8bbe\u7f6e\u4f5c\u4e1a\u540d\uff0c\u5c06ods\u5c42\u7684\u76f8\u5173\u4e1a\u52a1\u8868\u5408\u5e76\u5199\u5165\u5230dwd\u5c42\nSET 'pipeline.name' = 'dwd_business_order';\nINSERT INTO\ndwd.`dwd_business_order`\nSELECT\no.doccode,\n......,\nYEAR (o.docdate) AS o_year\n,TO_TIMESTAMP(CONVERT_TZ(cast(CURRENT_TIMESTAMP as varchar), 'UTC', 'Asia/Shanghai')) AS `create_date`\nFROM\nods.ods_shy_jh_doc_hdworkdochd o\nINNER JOIN ods.ods_shy_base_enterprise en ON o.businessguid = en.entguid\nLEFT JOIN dim.dim_hhl_user_code sales ON o.salesguid = sales.USER_GUID\nLEFT JOIN dim.dim_hhl_user_code op ON o.bookingguid = op.USER_GUID\nUNION ALL\nSELECT\nbusiness_no,\n......,\nYEAR ( gmt_create ) AS o_year\n,TO_TIMESTAMP(CONVERT_TZ(cast(CURRENT_TIMESTAMP as varchar), 'UTC', 'Asia/Shanghai')) AS `create_date`\nFROM\nods.ods_bondexsea_doc_order\nUNION ALL\nSELECT\n  HBLIndex,\n ......,\n  YEAR ( CreateOPDate ) AS o_year\n,TO_TIMESTAMP(CONVERT_TZ(cast(CURRENT_TIMESTAMP as varchar), 'UTC', 'Asia/Shanghai')) AS `create_date`\nFROM\n  ods.`ods_airsea_airfreight_orderhawb`\n;\n")),(0,r.kt)("p",null,"flink ui \u53ef\u4ee5\u770b\u5230 ods \u6570\u636e\u7ecf\u8fc7 paimon \u5b9e\u65f6 join \u6e05\u6d17\u5230\u8868 dwd_business_order"),(0,r.kt)("p",null,(0,r.kt)("img",{src:a(44173).Z,width:"1080",height:"646"})),(0,r.kt)("p",null,"2.\u5c06dwd\u5c42\u6570\u636e\u8f7b\u5ea6\u805a\u5408\u5230dwm\u5c42\u4e2d\uff0c\u5c06\u76f8\u5173\u6570\u636e\u5199\u5165dwm.",(0,r.kt)("inlineCode",{parentName:"p"},"dwm_business_order_count")," \u8868\u4e2d\uff0c\u8be5\u8868\u6570\u636e\u4f1a\u6839\u636e\u4e3b\u952e\u5bf9\u805a\u5408\u5b57\u6bb5\u505a sum\uff0csum_orderCount \u5b57\u6bb5\u5c31\u662f\u805a\u5408\u7ed3\u679c\uff0c\u7269\u7406\u5220\u9664\u7684\u6570\u636e sum \u65f6 paimon \u4f1a\u81ea\u52a8\u5904\u7406\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"-- \u521b\u5efadwm\u5c42\u8f7b\u5ea6\u6c47\u603b\u8868\uff0c\u6839\u636e\u65e5\u671f\u3001\u9500\u552e\u3001\u64cd\u4f5c\u3001\u4e1a\u52a1\u7c7b\u522b\u3001\u5ba2\u6237\u3001\u8d77\u8fd0\u6e2f\u3001\u76ee\u7684\u6e2f\u6c47\u603b\u5355\u91cf\nCREATE TABLE IF NOT EXISTS dwm.`dwm_business_order_count` (\n`l_year` BIGINT NOT NULL COMMENT '\u7edf\u8ba1\u5e74',\n`l_month` BIGINT NOT NULL COMMENT '\u7edf\u8ba1\u6708',\n`l_date` DATE NOT NULL  COMMENT '\u7edf\u8ba1\u65e5\u671f',\n`bondex_shy_flag` varchar(8) NOT NULL COMMENT '\u533a\u5206',\n`order_type_name` varchar(50) NOT NULL COMMENT '\u4e1a\u52a1\u5206\u7c7b',\n`is_server_item` int NOT NULL COMMENT '\u662f\u5426\u5df2\u7ecf\u5173\u8054\u8ba2\u5355',\n`customer_code` varchar(50) NOT NULL COMMENT '\u5ba2\u6237\u7f16\u53f7',\n`sales_code` varchar(50) NOT NULL COMMENT '\u9500\u552e\u7f16\u53f7',\n`delivery_center_op_id` varchar(50) NOT NULL COMMENT '\u4ea4\u4ed8\u7f16\u53f7',\n`pol_code` varchar(100) NOT NULL COMMENT '\u8d77\u8fd0\u6e2f\u4ee3\u7801',\n`pot_code` varchar(100) NOT NULL COMMENT '\u4e2d\u8f6c\u6e2f\u4ee3\u7801',\n`port_of_dest_code` varchar(100) NOT NULL COMMENT '\u76ee\u7684\u6e2f\u4ee3\u7801',\n`customer_name` varchar(200) NOT NULL COMMENT '\u5ba2\u6237\u540d\u79f0',\n`sales_name` varchar(200) NOT NULL COMMENT '\u9500\u552e\u540d\u79f0',\n`delivery_center_op_name` varchar(200) NOT NULL COMMENT '\u4ea4\u4ed8\u540d\u79f0',\n`sum_orderCount` BIGINT NOT NULL COMMENT '\u8ba2\u5355\u6570',\n`create_date` timestamp NOT NULL COMMENT '\u521b\u5efa\u65f6\u95f4',\nPRIMARY KEY (`l_year`,\n             `l_month`,\n             `l_date`,\n             `order_type_name`,\n             `bondex_shy_flag`,\n             `is_server_item`,\n             `customer_code`,\n             `sales_code`,\n             `delivery_center_op_id`,\n             `pol_code`,\n             `pot_code`,\n             `port_of_dest_code`) NOT ENFORCED\n) WITH (\n'changelog-producer' = 'full-compaction',\n  'changelog-producer.compaction-interval' = '2m',\n  'merge-engine' = 'aggregation', -- \u4f7f\u7528 aggregation \u805a\u5408\u8ba1\u7b97 sum\n  'fields.sum_orderCount.aggregate-function' = 'sum',\n  'fields.create_date.ignore-retract'='true',\n  'fields.sales_name.ignore-retract'='true',\n  'fields.customer_name.ignore-retract'='true',\n  'snapshot.time-retained' = '2h',\n'fields.delivery_center_op_name.ignore-retract'='true'\n);\n-- \u8bbe\u7f6e\u4f5c\u4e1a\u540d\nSET 'pipeline.name' = 'dwm_business_order_count';\nINSERT INTO\ndwm.`dwm_business_order_count`\nSELECT\nYEAR(o.`consignor_date`) AS `l_year`\n,MONTH(o.`consignor_date`) AS `l_month`\n......,\n,TO_TIMESTAMP(CONVERT_TZ(cast(CURRENT_TIMESTAMP as varchar), 'UTC', 'Asia/Shanghai')) AS create_date\nFROM\ndwd.`dwd_business_order` o\n;\n")),(0,r.kt)("p",null,"Flink UI \u6548\u679c\u5982\u4e0b dwd_business_orders \u6570\u636e\u805a\u5408\u5199\u5230 dwm_business_order_count\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{src:a(57362).Z,width:"194",height:"649"})),(0,r.kt)("p",null,"4.\u5c06 dwm \u5c42\u6570\u636e\u805a\u5408\u5230 dws \u5c42\u4e2d\uff0cdws \u5c42\u662f\u505a\u4e86\u66f4\u5c0f\u7ef4\u5ea6\u7684\u6c47\u603b"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"-- \u521b\u5efa\u6839\u636e\u64cd\u4f5c\u4eba\u3001\u4e1a\u52a1\u7c7b\u578b\u805a\u5408\u5f53\u5929\u7684\u5355\u91cf\nCREATE TABLE IF NOT EXISTS dws.`dws_business_order_count_op` (\n  `l_year` BIGINT NOT NULL COMMENT '\u7edf\u8ba1\u5e74',\n  `l_month` BIGINT NOT NULL COMMENT '\u7edf\u8ba1\u6708',\n  `l_date` DATE NOT NULL  COMMENT '\u7edf\u8ba1\u65e5\u671f',\n  `order_type_name` varchar(50) NOT NULL COMMENT '\u4e1a\u52a1\u5206\u7c7b',\n  `delivery_center_op_id` varchar(50) NOT NULL COMMENT '\u4ea4\u4ed8\u7f16\u53f7',\n  `delivery_center_op_name` varchar(200) NOT NULL COMMENT '\u4ea4\u4ed8\u540d\u79f0',\n  `sum_orderCount` BIGINT NOT NULL COMMENT '\u8ba2\u5355\u6570',\n  `create_date` timestamp NOT NULL COMMENT '\u521b\u5efa\u65f6\u95f4',\n  PRIMARY KEY (`l_year`, `l_month`,`l_date`,`order_type_name`,`delivery_center_op_id`) NOT ENFORCED\n) WITH (\n  'merge-engine' = 'aggregation', -- \u4f7f\u7528 aggregation \u805a\u5408\u8ba1\u7b97 sum\n  'fields.sum_orderCount.aggregate-function' = 'sum',\n  'fields.create_date.ignore-retract'='true',\n  'snapshot.time-retained' = '2h',\n  'fields.delivery_center_op_name.ignore-retract'='true'\n);\n-- \u8bbe\u7f6e\u4f5c\u4e1a\u540d\nSET 'pipeline.name' = 'dws_business_order_count_op';\nINSERT INTO\n  dws.`dws_business_order_count_op`\nSELECT\n  o.`l_year`\n  ,o.`l_month`\n  ,o.`l_date`\n  ,o.`order_type_name`\n  ,o.`delivery_center_op_id`\n  ,o.`delivery_center_op_name`\n  ,o.`sum_orderCount`\n  ,TO_TIMESTAMP(CONVERT_TZ(cast(CURRENT_TIMESTAMP as varchar), 'UTC', 'Asia/Shanghai')) AS create_date\nFROM\n  dwm.`dwm_business_order_count` o\n;\n")),(0,r.kt)("p",null,"Flink UI \u6548\u679c\u5982\u4e0b dws_business_order_count_op \u6570\u636e\u5199\u5230 dws_business_order_count_op\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{src:a(76380).Z,width:"191",height:"630"})),(0,r.kt)("p",null,"\u603b\u4f53\u6570\u636e\u6d41\u8f6c\u793a\u4f8b"),(0,r.kt)("p",null,(0,r.kt)("img",{src:a(75308).Z,width:"1080",height:"515"})),(0,r.kt)("p",null,"\u6e90\u8868\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{src:a(87256).Z,width:"1080",height:"100"})),(0,r.kt)("p",null,"paimon-ods:"),(0,r.kt)("p",null,(0,r.kt)("img",{src:a(74586).Z,width:"1080",height:"94"})),(0,r.kt)("p",null,"paimon-dwd:"),(0,r.kt)("p",null,(0,r.kt)("img",{src:a(16566).Z,width:"1080",height:"95"})),(0,r.kt)("p",null,"paimon-dwm:"),(0,r.kt)("p",null,(0,r.kt)("img",{src:a(74572).Z,width:"1080",height:"39"})),(0,r.kt)("p",null,"paimon-dws:"),(0,r.kt)("p",null,(0,r.kt)("img",{src:a(91155).Z,width:"1080",height:"56"})),(0,r.kt)("p",null,"\u7279\u522b\u63d0\u9192 sqlserver \u6570\u636e\u5e93\u62bd\u53d6\u65f6\u5982\u679c\u6e90\u8868\u6570\u636e\u91cf\u8fc7\u5927\u5168\u91cf\u62bd\u53d6\u4f1a\u9501\u8868\uff0c\u5efa\u8bae\u5728\u4e1a\u52a1\u5141\u8bb8\u7684\u60c5\u51b5\u4e0b\u91c7\u7528\u589e\u91cf\u62bd\u53d6\u3002\u5bf9\u4e8e\u5168\u91cf\u62bd\u53d6 sqlserver \u53ef\u4ee5\u91c7\u7528\u4e2d\u8f6c\u7684\u65b9\u5f0f sqlserver \u5168\u91cf\u6570\u636e\u5bfc\u5165\u5230 mysql\uff0c\u4ece mysql \u518d\u5230 paimon-ods ,\u540e\u9762\u518d\u901a\u8fc7 sqlserever \u505a\u589e\u91cf\u62bd\u53d6\u3002"),(0,r.kt)("h2",{id:"04-\u95ee\u9898\u6392\u67e5\u5206\u6790"},"04 \u95ee\u9898\u6392\u67e5\u5206\u6790"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"1. \u805a\u5408\u6570\u636e\u8ba1\u7b97\u4e0d\u51c6")),(0,r.kt)("p",null,"sqlserver cdc \u91c7\u96c6\u6570\u636e\u5230 paimon \u8868\uff0c\u8bf4\u660e\uff1a"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"dwd \u8868\uff1a")),(0,r.kt)("p",null,"'changelog-producer' = 'input'"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"ads \u8868\uff1a")),(0,r.kt)("p",null,"'merge-engine' = 'aggregation',  -- \u4f7f\u7528 aggregation \u805a\u5408\u8ba1\u7b97 sum"),(0,r.kt)("p",null,"'fields.sum_amount.aggregate-function' = 'sum'"),(0,r.kt)("p",null,"ADS \u5c42\u805a\u5408\u8868\u91c7\u7528 agg sum \u4f1a\u51fa\u73b0 dwd \u6570\u636e\u6d41\u4e0d\u4ea7\u751f update_before\uff0c\u4ea7\u751f\u9519\u8bef\u6570\u636e\u6d41 update_after  \u6bd4\u5982\u4e0a\u6e38\u6e90\u8868 update 10 \u5230 30 dwd \u5c42\u6570\u636e\u4f1a\u53d8\u66f4\u4e3a 30\uff0cads \u805a\u5408\u5c42\u6570\u636e\u4e5f\u4f1a\u53d8\u66f4\u4e3a 30\uff0c\u4f46\u662f\u73b0\u5728\u53d8\u4e3a\u4e86 append \u6570\u636e\u53d8\u6210\u4e86 10+30=40 \u7684\u9519\u8bef\u6570\u636e\u3002"),(0,r.kt)("p",null,"\u89e3\u51b3\u529e\u6cd5\uff1a"),(0,r.kt)("p",null,"By specifying 'changelog-producer' = 'full-compaction',\nTable Store will compare the results between full compactions and produce the differences as changelog.\nThe latency of changelog is affected by the frequency of full compactions."),(0,r.kt)("p",null,"By specifying changelog-producer.compaction-interval table property (default value 30min),\nusers can define the maximum interval between two full compactions to ensure latency.\nThis table property does not affect normal compactions and they may still be performed once in a while by writers to reduce reader costs."),(0,r.kt)("p",null,"\u8fd9\u6837\u80fd\u89e3\u51b3\u4e0a\u8ff0\u95ee\u9898\u3002\u4f46\u662f\u968f\u4e4b\u800c\u6765\u51fa\u73b0\u4e86\u65b0\u7684\u95ee\u9898\u3002\u9ed8\u8ba4 changelog-producer.compaction-interval \u662f 30min\uff0c\u610f\u5473\u7740 \u4e0a\u6e38\u7684\u6539\u52a8\u5230 ads \u67e5\u8be2\u8981\u95f4\u9694 30min\uff0c\u751f\u4ea7\u8fc7\u7a0b\u4e2d\u53d1\u73b0\u5c06\u538b\u7f29\u95f4\u9694\u65f6\u95f4\u6539\u6210 1min \u6216\u8005 2 \u5206\u949f\u7684\u60c5\u51b5\u4e0b\uff0c\u53c8\u4f1a\u51fa\u73b0\u4e0a\u8ff0 ADS \u5c42\u805a\u5408\u6570\u636e\u4e0d\u51c6\u7684\u60c5\u51b5\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"'changelog-producer.compaction-interval' = '2m'\n")),(0,r.kt)("p",null,"\u9700\u8981\u5728\u5199\u5165 Flink Table Store \u65f6\u9700\u8981\u914d\u7f6e table.exec.sink.upsert-materialize= none\uff0c\u907f\u514d\u4ea7\u751f Upsert \u6d41\uff0c\u4ee5\u4fdd\u8bc1 Flink Table Store \u4e2d\u80fd\u591f\u4fdd\u5b58\u5b8c\u6574\u7684 changelog\uff0c\u4e3a\u540e\u7eed\u7684\u6d41\u8bfb\u64cd\u4f5c\u505a\u51c6\u5907\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"set 'table.exec.sink.upsert-materialize' = 'none'\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"2. \u76f8\u540c sequence.field \u5bfc\u81f4 dwd \u660e\u7ec6\u5bbd\u8868\u65e0\u6cd5\u6536\u5230 update \u6570\u636e\u66f4\u65b0")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"mysql cdc \u91c7\u96c6\u6570\u636e\u5230 paimon \u8868")),(0,r.kt)("p",null,"\u8bf4\u660e\uff1a"),(0,r.kt)("p",null,"\u5728 MySQL \u6e90\u7aef\u6267\u884c update \u6570\u636e\u4fee\u6539\u6210\u529f\u540e\uff0cdwd_orders \u8868\u6570\u636e\u80fd\u540c\u6b65\u6210\u529f"),(0,r.kt)("p",null,(0,r.kt)("img",{src:a(30673).Z,width:"1080",height:"558"})),(0,r.kt)("p",null,"\u4f46\u662f\u67e5\u770b dwd_enriched_orders \u8868\u6570\u636e\u65e0\u6cd5\u540c\u6b65\uff0c\u542f\u52a8\u6d41\u6a21\u5f0f\u67e5\u770b\u6570\u636e\uff0c\u53d1\u73b0\u6ca1\u6709\u6570\u636e\u6d41\u5411"),(0,r.kt)("p",null,(0,r.kt)("img",{src:a(33397).Z,width:"1080",height:"357"})),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u89e3\u51b3\uff1a")),(0,r.kt)("p",null,"\u6392\u67e5\u53d1\u73b0\u662f\u7531\u4e8e\u914d\u7f6e\u4e86\u53c2\u6570 'sequence.field' = 'o_orderdate'\uff08\u4f7f\u7528 o_orderdate \u751f\u6210 sequence id\uff0c\u76f8\u540c\u4e3b\u952e\u5408\u5e76\u65f6\u9009\u62e9 sequence id \u66f4\u5927\u7684\u8bb0\u5f55\uff09\u5bfc\u81f4\u7684\uff0c\u56e0\u4e3a\u5728\u4fee\u6539\u4ef7\u683c\u7684\u65f6\u5019 o_orderdate \u5b57\u6bb5\u65f6\u95f4\u4e0d\u53d8\uff0c \u7ee7\u800c'sequence.field' \u662f\u76f8\u540c\u7684\uff0c\u5bfc\u81f4\u987a\u5e8f\u4e0d\u786e\u5b9a\uff0c\u6240\u4ee5 ROW1 \u548c ROW2\uff0c\u5b83\u4eec\u7684 o_orderdate \u662f\u4e00\u6837\u7684\uff0c\u6240\u4ee5\u5728\u66f4\u65b0\u65f6\u4f1a\u968f\u673a\u9009\u62e9\uff0c\u6240\u6709\u5c06\u8be5\u53c2\u6570\u53bb\u6389\u5373\u53ef\uff0c\u53bb\u6389\u540e\u6b63\u5e38\u6309\u7167\u8f93\u5165\u7684\u5148\u540e\u987a\u5e8f\uff0c\u81ea\u52a8\u751f\u6210\u4e00\u4e2a sequence number\uff0c\u4e0d\u4f1a\u5f71\u54cd\u540c\u6b65\u7ed3\u679c\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"3. Aggregate function 'last_non_null_value' does not support retraction")),(0,r.kt)("p",null,"\u62a5\u9519\uff1a\nCaused by: java.lang.UnsupportedOperationException: Aggregate function 'last_non_null_value' does not support retraction, If you allow this function to ignore retraction messages, you can configure 'fields.${field_name}.ignore-retract'='true'."),(0,r.kt)("p",null,"\u53ef\u4ee5\u5728\u5b98\u65b9\u6587\u6863\u627e\u5230\u89e3\u91ca\uff1a"),(0,r.kt)("p",null,"Only sum supports retraction (UPDATE_BEFORE and DELETE), others aggregate functions do not support retraction."),(0,r.kt)("p",null,"\u53ef\u4ee5\u7406\u89e3\u4e3a\uff1a\u9664\u4e86 SUM \u51fd\u6570\uff0c\u5176\u4ed6\u7684 Agg \u51fd\u6570\u90fd\u4e0d\u652f\u6301 Retraction\uff0c\u4e3a\u4e86\u907f\u514d\u63a5\u6536\u5230 DELETE \u548c UPDATEBEFORE \u6d88\u606f\u62a5\u9519\uff0c\u9700\u8981\u901a\u8fc7\u7ed9\u6307\u5b9a\u5b57\u6bb5\u914d 'fields.${field_name}.ignore-retract'='true' \u5ffd\u7565\uff0c\u89e3\u51b3\u8fd9\u4e2a\u62a5\u9519"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"WITH (\n\n'merge-engine' = 'aggregation', -- \u4f7f\u7528 aggregation \u805a\u5408\u8ba1\u7b97 sum\n\n'fields.sum_orderCount.aggregate-function' = 'sum',\n\n'fields.create_date.ignore-retract'='true' #create_date \u5b57\u6bb5\n\n);\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"4. paimon\u4efb\u52a1\u4e2d\u65ad\u5931\u8d25")),(0,r.kt)("p",null,"\u4efb\u52a1\u5f02\u5e38\u4e2d\u65ad \u5bfc\u81f4pod\u6302\u6389\uff0c\u67e5\u770bloki\u65e5\u5fd7\u663e\u793aakka.pattern.AskTimeoutException: Ask timed out on"),(0,r.kt)("p",null,(0,r.kt)("img",{src:a(12687).Z,width:"1080",height:"288"})),(0,r.kt)("p",null,"java.util.concurrent.TimeoutException: Invocation of ","[RemoteRpcInvocation(JobMasterGateway.updateTaskExecutionState(TaskExecutionState))]"," at recipient ","[akka.tcp://flink@fts-business-order-count.streampark:6123/user/rpc/jobmanager_2]",' timed out. This is usually caused by: 1) Akka failed sending the message silently, due to problems like oversized payload or serialization failures. In that case, you should find detailed error information in the logs. 2) The recipient needs more time for responding, due to problems like slow machines or network jitters. In that case, you can try to increase akka.ask.timeout.\\n"'),(0,r.kt)("p",null,"\u521d\u6b65\u5224\u65ad\u5e94\u8be5\u662f\u7531\u4e8e\u4ee5\u4e0a2\u4e2a\u539f\u56e0\u5bfc\u81f4\u89e6\u53d1\u4e86 akka \u7684\u8d85\u65f6\u673a\u5236\uff0c\u90a3\u5c31\u8c03\u6574\u96c6\u7fa4\u7684akka\u8d85\u65f6\u95f4\u914d\u7f6e\u548c\u8fdb\u884c\u5355\u4e2a\u4efb\u52a1\u62c6\u5206\u6216\u8005\u8c03\u5927\u8d44\u6e90\u914d\u7f6e\u3002"),(0,r.kt)("p",null,"\u6211\u4eec\u8fd9\u8fb9\u5148\u770b\u5982\u4f55\u8fdb\u884c\u53c2\u6570\u4fee\u6539:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"key"),(0,r.kt)("th",{parentName:"tr",align:null},"default"),(0,r.kt)("th",{parentName:"tr",align:null},"describe"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"akka.ask.timeout"),(0,r.kt)("td",{parentName:"tr",align:null},"10s"),(0,r.kt)("td",{parentName:"tr",align:null},"Timeout used for all futures and blocking Akka calls. If Flink fails due to timeouts then you should try to increase this value. Timeouts can be caused by slow machines or a congested network. The timeout value requires a time-unit specifier (ms/s/min/h/d).")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"web.timeout"),(0,r.kt)("td",{parentName:"tr",align:null},"600000"),(0,r.kt)("td",{parentName:"tr",align:null},"Timeout for asynchronous operations by the web monitor in milliseconds.")))),(0,r.kt)("p",null,"\u5728 conf/flink-conf.yaml \u6700\u540e\u589e\u52a0\u4e0b\u9762\u53c2\u6570:"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"akka.ask.timeout: 100s")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"web.timeout:1000000")),(0,r.kt)("p",null,"\u7136\u540e\u5728 streampark \u624b\u52a8\u5237\u65b0\u4e0b flink-conf.yaml \u9a8c\u8bc1\u53c2\u6570\u662f\u5426\u540c\u6b65\u6210\u529f\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"5. snapshot no such file or director")),(0,r.kt)("p",null,"\u53d1\u73b0 cp \u51fa\u73b0\u5931\u8d25\u60c5\u51b5"),(0,r.kt)("p",null,(0,r.kt)("img",{src:a(70930).Z,width:"903",height:"502"})),(0,r.kt)("p",null,"\u5bf9\u5e94\u65f6\u95f4\u70b9\u65e5\u5fd7\u663e\u793a Snapshot \u4e22\u5931\uff0c\u4efb\u52a1\u663e\u793a\u4e3a running \u72b6\u6001\uff0c\u4f46\u662f\u6e90\u8868 mysql \u6570\u636e\u65e0\u6cd5\u5199\u5165 paimon ods \u8868"),(0,r.kt)("p",null,(0,r.kt)("img",{src:a(8449).Z,width:"1080",height:"360"})),(0,r.kt)("p",null,"\u5b9a\u4f4dcp\u5931\u8d25\u539f\u56e0\u4e3a\uff1a\u8ba1\u7b97\u91cf\u5927\uff0cCPU\u5bc6\u96c6\u6027\uff0c\u5bfc\u81f4TM\u5185\u7ebf\u7a0b\u4e00\u76f4\u5728processElement\uff0c\u800c\u6ca1\u6709\u65f6\u95f4\u505aCP"),(0,r.kt)("p",null,"\u65e0\u6cd5\u8bfb\u53d6 Snapshot \u539f\u56e0\u4e3a\uff1aflink \u96c6\u7fa4\u8d44\u6e90\u4e0d\u591f\uff0cWriter \u548c Committer \u4ea7\u751f\u7ade\u4e89\uff0cFull-Compaction \u65f6\u8bfb\u5230\u4e86\u5df2\u8fc7\u671f\u90e8\u5206\u7684\u4e0d\u5b8c\u6574\u7684 Snapshot\uff0c\u76ee\u524d\u5b98\u65b9\u9488\u5bf9\u8fd9\u4e2a\u95ee\u9898\u5df2\u7ecf\u4fee\u590d:"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/apache/incubator-paimon/pull/1308"},"https://github.com/apache/incubator-paimon/pull/1308")),(0,r.kt)("p",null,"\u800c\u89e3\u51b3 cp \u5931\u8d25\u7684\u89e3\u51b3\u529e\u6cd5\u589e\u52a0\u5e76\u884c\u5ea6\uff0c\u589e\u52a0 deploymenttaskmanager slot \u548c jobmanager cpu"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"-D kubernetes.jobmanager.cpu=0.8\n\n-D kubernetes.jobmanager.cpu.limit-factor=1\n\n-D taskmanager.numberOfTaskSlots=8\n\n-D jobmanager.adaptive-batch-scheduler.default-source-parallelism=2\n")),(0,r.kt)("p",null,(0,r.kt)("img",{src:a(14284).Z,width:"1080",height:"244"})),(0,r.kt)("p",null,(0,r.kt)("img",{src:a(60687).Z,width:"1080",height:"487"})),(0,r.kt)("p",null,"\u5728\u590d\u6742\u7684\u5b9e\u65f6\u4efb\u52a1\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539\u52a8\u6001\u53c2\u6570\u7684\u65b9\u5f0f\uff0c\u589e\u52a0\u8d44\u6e90\u3002"),(0,r.kt)("h2",{id:"05--\u672a-\u6765-\u89c4-\u5212"},"05  \u672a \u6765 \u89c4 \u5212"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u81ea\u5efa\u7684\u6570\u636e\u5e73\u53f0 bondata \u6b63\u5728\u96c6\u6210 paimon \u7684\u5143\u6570\u636e\u4fe1\u606f\u3001\u6570\u636e\u6307\u6807\u4f53\u7cfb\u3001\u8840\u7f18\u3001\u4e00\u952e pipline \u7b49\u529f\u80fd\uff0c\u5f62\u6210\u6d77\u7a0b\u90a6\u8fbe\u7684\u6570\u636e\u8d44\u4ea7\uff0c\u5e76\u5c06\u5728\u6b64\u57fa\u7840\u4e0a\u5c55\u5f00\u4e00\u7ad9\u5f0f\u6570\u636e\u6cbb\u7406"),(0,r.kt)("li",{parentName:"ul"},"\u540e\u9762\u5c06\u57fa\u4e8e trino Catalog\u63a5\u5165Doris\uff0c\u5b9e\u73b0\u771f\u6b63\u7684\u79bb\u7ebf\u6570\u636e\u548c\u5b9e\u65f6\u6570\u636e\u7684one service"),(0,r.kt)("li",{parentName:"ul"},"\u91c7\u7528 doris + paimon \u7684\u67b6\u6784\u65b9\u6848\u7ee7\u7eed\u63a8\u8fdb\u96c6\u56e2\u5185\u90e8\u6d41\u6279\u4e00\u4f53\u6570\u4ed3\u5efa\u8bbe\u7684\u6b65\u4f10")),(0,r.kt)("p",null,"\u5728\u8fd9\u91cc\u8981\u611f\u8c22\u4e4b\u4fe1\u8001\u5e08\u548c StreamPark \u793e\u533a\u5728\u4f7f\u7528 StreamPark + Paimon \u8fc7\u7a0b\u4e2d\u7684\u5927\u529b\u652f\u6301\uff0c\u5728\u5b66\u4e60\u4f7f\u7528\u8fc7\u7a0b\u4e2d\u9047\u5230\u7684\u95ee\u9898\uff0c\u90fd\u80fd\u5728\u7b2c\u4e00\u65f6\u95f4\u7ed9\u5230\u89e3\u60d1\u5e76\u5f97\u5230\u89e3\u51b3\uff0c\u6211\u4eec\u540e\u9762\u4e5f\u4f1a\u79ef\u6781\u53c2\u4e0e\u793e\u533a\u7684\u4ea4\u6d41\u548c\u5efa\u8bbe\uff0c\u8ba9 paimon \u80fd\u4e3a\u66f4\u591a\u5f00\u53d1\u8005\u548c\u4f01\u4e1a\u63d0\u4f9b\u6d41\u6279\u4e00\u4f53\u7684\u6570\u636e\u6e56\u89e3\u51b3\u65b9\u6848\u3002"))}d.isMDXComponent=!0},88048:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/Bondex-b9280a2451e6984d91f7747acaa10b97.png"},1183:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/aliyun-43dec052b5792743675fb5a0e5980ebc.png"},75308:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/all_datastream-f095c45ce30fe21e178eac323c6a7a37.jpg"},6169:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/application_setting-48542837b22debfeca15eddaf6ea93a0.png"},70930:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/cp_fail-a5b4c7c1cd38f2563b651b23daab8140.jpg"},86466:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/dockersystem_setting-60d5b7d9e930185cf1a9a404beab9dc0.png"},44173:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/dwd_business_order-a017b7fa6dac855794cf9720a0421090.png"},30673:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/dwd_orders-8343ec8277c69354f8ee7cac0c4c9f91.png"},57362:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/dwm_business_order_count-1abbcf7d6b31f15e49f2e035ecfdb8d7.png"},76380:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/dws_business_order_count_op-72bb62943dcef89451b47db142cfe689.png"},14284:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/dynamic_properties-33cd67364d80285f0e480974a60d52ff.jpg"},85186:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/flink_conf-1c8b9773c6678621a140320ae2a8525f.jpg"},60687:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/flink_dashboard-4bcca1ae4f103249bd7c6c48625a4959.png"},79263:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/kappa-924eb8691ece5d996d9aa740e5b79230.png"},70896:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/lambda-e357a7e34ced4e82971d4b86acc790b4.png"},33397:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/log-42ef92b8036ed3698fb0fbb1abdaecab.png"},12687:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/loki-372203296a8af19f7a32fcd2162fdc29.png"},60002:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/ods-bc0d5ecbef808b0ca349311569803f18.png"},16566:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/paimon-dwd-d3b020d2bd2b78c26944a6928be39e4e.png"},74572:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/paimon-dwm-778a748d6b64c9e61d73e6b6da1d625f.png"},91155:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/paimon-dws-632e1291e21c4f628f7e87ca03ae5c6f.png"},74586:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/paimon-ods-876cf67ff375c0b5cb67d4a0e555b1a3.png"},22276:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/paimon_catalog_setting-aa6a826f1cb1a7d9c90fc3fae71a0ef3.png"},58851:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/pipline-60b68a9487092b6866020ce983a85ac0.png"},32295:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/pod_template-4a36a24383f78f09d3090e5ddf7fe1fa.png"},81275:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/pom-949e43be1f8e611776858b7573047de2.jpg"},10900:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/realtime_warehouse-418beb6d713966065d731eb8417b8a6e.png"},87256:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/source-afa30e0d3ab0116582cc4bd7831ce2ca.png"},8449:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/status_log-eed735d5dc4c6954042376d7b6f12388.png"},34299:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/streaming_warehouse-ab83b309ef461f3907c2df023143c817.png"}}]);